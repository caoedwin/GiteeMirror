{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}lesson_form_upload{% endblock %}
{% block css %}
 <link href="/static/css/b_upload.css" rel="stylesheet">
<link href="/static/css/uploadbutton.css" rel="stylesheet">
{% endblock %}
{% block content %}
<div class="container">
  <div class="card" style="background-color:rgba(255,255,255,0.2)">
          <!--<div class="card-header">Execl</div>-->
          <div class="card-body">
           <div class="b-fileUpload">
                   <p style="color: #FFF">Execl 文件上傳:</p>
                   <input type="file" style="color: #FFF" id="xlsxUpload"  accept=".xlsx"/>
                   <input type="button" id="xlsxSubmit" onclick="Upload(this)" VALUE="Submit">
           </div>
          </div>
  </div>
  <form method="POST" action="/Bouncing/Bouncing-upload/" enctype="multipart/form-data">
  <div class="card" style="background: rgba(255,255,255,0.2);">
    <div class="card-header title" style="color: #FFF">Bouncing Data Upload</div>
       <div class="card-body" id="publicMsg">
           <label for="Customer" style="color: #FFF">客户:</label>
           {% comment %}<select id="Customer">
               <option>C38(NB)</option>
               <option>C38(AIO)</option>
               <option>A39</option>
               <option>Other</option>
           </select>{% endcomment %}
           {{ buncing_upload.Customer }}
           <label for="Project" style="color: #FFF">专案:</label>
           {% comment %}<select id="Project">
               <option>EL543</option>
               <option>EL4C2</option>
           </select>{% endcomment %}
           {{ buncing_upload.Project }}
           <div id="showResult" class="err_msg">上传结果：<span id="showErrResult"></span></div>
       </div>
  </div>
   <div class="card" style="background: rgba(255,255,255,0.2);">
    <div class="card-body" >
         <div class="first-part">
          <div class="input-group-prepend">
             <span class="input-group-text">A件</span>
           </div>

             {{ buncing_upload.A_cover }}
          <div class="input-group-prepend">
             <span class="input-group-text">C件</span>
          </div>
             {% comment %}<select class="form-control-new"  id="c-cover" name="c-cover" data-toggle="dropdown">
                 <option></option>
                 <option>Mg_AL</option>
                 <option>Plasttic</option>
                 <option>metral</option>
             </select>{% endcomment %}
           {{ buncing_upload.C_cover }}
           <div class="input-group-prepend">
             <span class="input-group-text">D件</span>
           </div>

             {{ buncing_upload.D_cover }}
          <div class="input-group-prepend">
             <span class="input-group-text">转轴</span>
          </div>
          <!--<input type="text" class="form-control-new" id="hinge-s" >-->
            {{ buncing_upload.HS }}
        </div>
       </div>
    <div class="card-body" >
        <div class="second-part">
            <div class="card">
                <div class="card-body">
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">扭力</span>
                     </div>
                      <input type="text" class="form-control-new" style="color: #FFF" name="Torque_min" value="Min" readonly="readonly">

                    </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">推力</span>
                     </div>
                     <!-- <input type="text" class="form-control-new" id="push_f-min" name="username">-->
                        {{ buncing_upload.Push_min }}
                     </div>
                     <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">峰值-左</span>
                     </div>
                      <!--<input type="text" class="form-control-new" id="Peak_Value_Left-min" name="username">-->
                         {{ buncing_upload.PV_L_min }}
                     </div>
                     <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">峰值-右</span>
                     </div>
                      <!--<input type="text" class="form-control-new" id="Peak_Value_right-min" name="username">-->
                         {{ buncing_upload.PV_R_min }}
                     </div>
                     <div class="row_1">
                      <div class="input-group-prepend">
                      <span class="input-group-text">Distance-左</span>
                      </div>
                      <!--<input type="text" class="form-control-new" id="Distance_Left-min" name="username">-->
                         {{ buncing_upload.D_L_min }}
                    </div>
                    <div class="row_1">
                    <div class="input-group-prepend">
                    <span class="input-group-text">Distance-右</span>
                    </div>
                    <!--<input type="text" class="form-control-new" id="Distance_ight-min" name="username">-->
                        {{ buncing_upload.D_R_min }}
                    </div>
             </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">扭力</span>
                     </div>
                      <input type="text" class="form-control-new" style="color: #FFF" name="Torque_max" value="Max" readonly="readonly">

                    </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">推力</span>
                     </div>
                      <!--<input type="text" class="form-control-new" id="push_f-max" name="username">-->
                        {{ buncing_upload.Push_max }}
                     </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">峰值-左</span>
                     </div>
                      <!--<input type="text" class="form-control-new" id="Peak_Value_Left-max" name="username">-->
                        {{ buncing_upload.PV_L_max }}
                     </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                       <span class="input-group-text">峰值-右</span>
                     </div>
                      <!--<input type="text" class="form-control-new" id="Peak_Value_right-max" name="username">-->
                         {{ buncing_upload.PV_R_max }}
                     </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                      <span class="input-group-text">Distance-左</span>
                      </div>
                      <!--<input type="text" class="form-control-new" id="Distance_Left-max" name="username">-->
                        {{ buncing_upload.D_L_max }}
                    </div>
                    <div class="row_1">
                      <div class="input-group-prepend">
                      <span class="input-group-text">Distance-右</span>
                    </div>
                      {{ buncing_upload.D_R_max }}
                    </div>
                </div>
            </div>
        </div>
         </div>
    <div class="card-body" >
        <div class="third-part">
            <div class="content">
                <label for="Conclusion" class="input-group-text">结论 </label>
                <textarea id="Conclusion" rows="3" cols="79" class="textarea-style" id="conclusion" name="Conclusion"></textarea>
            </div>
        </div>
        </div>
   <div style="background-color: rgba(255,255,255,0);height:80px;width:1150px;margin:0 auto;border-radius:0px 0px 10px 10px;" class="breadcrumb">

                        <span style="color:#FFF">附件</span>
                         <div class="col-sm-8">
                             <input style="color: #FFF" type="file" id="upload-file" name="myfiles" multiple="">
                         </div>
        </div>
    <div class="card-body" >
       <div class="forth-part">
            <div class="center">
             <button type="submit" onclick="" class="btn btn-info" name="Upload" id="upload1">Upload</button>
             <button class="btn btn-default">Cancel</button>
            </div>
       </div>
     </div>
     {% csrf_token %}
   </div>
  </form>

</div>

<!-- 彈出信息提示，用來顯示內容上傳成功和失敗 -->
<div class="modal fade" id="returnMsg" tabindex="-1" role="dialog" aria-labelledby="returnTitle" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="returnTitle">Upload Result</h5>
              <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
              </button>
            </div>
            <div class="modal-body" id="msgContent"></div>
            <div class="modal-footer">
              <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>

            </div>
          </div>
        </div>
        </div>

{% endblock %}
{% block scripts %}
<script src="/static/js/xlsx/xlsx.js"></script>
<script>
var backResult=['Pass','Fail','上传数据成功','上传数据重复'];
window.onload=function(){
    var el =document.getElementById("showErrResult");

    var result={{ result  }};
    console.log(backResult[result]);
    if(result==0){

        el.innerHTML=backResult[result+2];
        $("#showErrResult").css({"color":"green"});
        $("#showResult").css({"display":"block"});
        //alert(backResult[result+2]);
        setTimeout(function () {
            $("#showResult").css({"display":"none"});
        },3000);
    }
    else if(result==1){
        el.innerHTML=backResult[result+2];
        $("#showErrResult").css({"color":"red"});
        $("#showResult").css({"display":"block"});
        alert(backResult[result+2]);
    }
    else {

    }
    var isNum = function (value) {
        var reg = /^[0-9]+.?[0-9]*$/;
        if (reg.test(value)) {
        return true;
        }
        return false;
    }
    //关闭滚轮事件
    var inputMouseScroll = document.getElementsByClassName("form-control-new");
    //console.log(inputMouseScroll[0]);
    for(var formNum in inputMouseScroll){
          //console.log(typeof(formNum));
        if(isNum(formNum)){
           //console.log(inputMouseScroll[formNum]);
           inputMouseScroll[formNum].addEventListener("mousewheel",function(evt){
           evt = evt || window.event;
           if(evt.preventDefault) {
           // Firefox
          evt.preventDefault();
          evt.stopPropagation();
        } else {
          // IE
          evt.cancelBubble=true;
          evt.returnValue = false;
        }
      });
        }
    }

}
</script>
    <script src="/static/js/ImgUpload.js"></script>
{% endblock %}
