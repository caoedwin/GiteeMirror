{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}PersonalInfo_edit{% endblock %}
{% block css %}
<link rel="stylesheet" href="/static/css/index.css">
<style>
label{
    color:white;
}
 .selectMsg{
     font-size:16px;
      padding: 15px;
      display: flex;
      flex-wrap: wrap;
  }
  .selectMsg label{
      font-weight: 800;
      margin-right: 10px;
      color:aliceblue;
  }
  .customerContent,.departmentContent,.lessonContent,.groupemployeesContent{
     margin-left: 20px;
}

.inputError{
    text-align: center;
    color: crimson;
    background-color: beige;
    width: 50%;
    margin: 10px auto 5px;
    position: relative;
}
  .inputError:before{
    display:block;
    content:'';
    border-width:8px 8px 8px 8px;
    border-style:solid;
    border-color:transparent transparent beige transparent;

    /* 定位 */
    position:absolute;
    left:50%;
    top:-16px;
}
  .fileUploadContent{
    display: inline-flex;
    display: -webkit-inline-flex;
}
  .fileUploadContent label{
    display: inline-block;
    word-break: keep-all;
    line-height: 30px;
}
.el-checkbox__label{
    font-size: 18px;
}
 .fileUploadContent{
    padding-left: 15px;
    margin-bottom: 10px;
  }
  .inputPackage{
    background: #2980b9;  /* fallback for old browsers */
    background: -webkit-linear-gradient(to right, rgb(41, 128, 185), rgb(109, 213, 250)); /* Chrome 10-25, Safari 5.1-6 */
    background: linear-gradient(to right, rgb(41, 128, 185), rgb(109, 213, 250)); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    display: block;
    position: relative;
    border-radius: 5px;
    margin-right: 10px;
  }
  .inputPackage span{
    position: absolute;
    line-height: 100%;
    transform: translate(-50%, -50%);
    top: 50%;
    left: 50%;
    color: aliceblue;
  }
  .fileUploadContent .showFileName{
     line-height: 40px;
     margin-left: 20px;
     font-size: 18px;
     color: aliceblue;
   }
  .inputPackage input{
      opacity: 0;
      width: 100%;
      height: 100%;
  }
 .selectItem{
    font-size: 20px;
    font-weight: bold;
    color: aliceblue;
}
  .tableAround{
    padding: 20px;
    -moz-box-shadow: 0px 0px 10px #333333;
    -webkit-box-shadow: 0px 0px 10px #333333;
    box-shadow: 0px 0px 10px #333333;
    border-radius: 10px;
    background-color: rgba(255,255,255,0.1);
}
.el-pagination__total,.el-pagination__jump{
        color:white;
    }
.gutter{
    display:block!important;
    width:17px!important;
}
</style>
{% endblock %}
{% block content %}
<div id="app">
      <!--搜索框-->
    <div class="selectMsg" >
           <div class="yearContent">
                 <label for="year">年份: </label>
                 <el-date-picker ref="Year" value-format="yyyy" v-model="year" type="year" placeholder="選擇年份" style="height:40px;width:100px;border-radius:5px 5px 5px 5px;"></el-date-picker>
           </div>
           <div class="customerContent">
                 <label for="customer">客戶別: </label>
                 <select  ref="Customer"  @change="changeCustomer" v-model="customer" style="height:40px;width:100px;border-radius:5px 5px 5px 5px;">
                       <option value="All">All</option>
                       <option v-for="(item,key,index) in customerOptions" >${ key }</option>
                 </select>
{#                 <div class="inputError" v-cloak v-show="customerError">不能為空</div>#}
           </div>
           <div class="departmentContent">
                  <label for="department">部門:</label>
                  <select  ref="Department"  @change="changeDepartment" v-model="department" style="height:40px;border-radius:5px 5px 5px 5px;width:100px;">
                       <option value="All">All</option>
                       <option v-for="(item,key,index) in departmentOptions">${ item.Department }</option>
                  </select>
{#                  <div class="inputError" v-cloak  v-show="departmentError">不能為空</div>#}
           </div>
           <div class="lessonContent">
                  <label for="lesson">課别:</label>
{#                  <select  ref="Lesson"  @change="changeLesson" v-model="lesson" style="height:40px;border-radius:5px 5px 5px 5px;width:120px;">#}
                  <select  ref="Lesson"  v-model="lesson" style="height:40px;border-radius:5px 5px 5px 5px;width:120px;">
                       <option value="All">All</option>
                       <option v-for="(item,key,index) in lessonOptions">${ key }</option>
                  </select>
{#                  <div class="inputError" v-cloak  v-show="lessonError">不能為空</div>#}
           </div>
           <div class="groupemployeesContent">
                 <label for="groupemployees">集團員工: </label>
                   <el-autocomplete
                      ref="GroupEmployees"
                      class="inline-input"
                      v-model="groupemployees"
                      :fetch-suggestions="querySearchGroupEmployee"
                      placeholder="请输入内容"
                      @select="handleSelect"
                 ></el-autocomplete>
{#                 <select  ref="GroupEmployees"   v-model="groupemployees" style="height:40px;border-radius:5px 5px 5px 5px;width:100px;">#}
{#                       <option value="All">All</option>#}
{#                       <option v-for="(item,key,index) in GroupEmployeesNum">${ item }</option>#}
{#                 </select>#}
{#                 <div class="inputError" v-cloak v-show="groupemployeesError">不能為空</div>#}
           </div>
                 &nbsp;&nbsp;&nbsp;
                 <el-button @click="find" v-cloak type="primary" style="height:40px">搜索</el-button>
                 <el-button @click="exportExcel" v-cloak type="info" style="height:40px">導出</el-button>
        <div  class="selectMsg" style="margin-right:10px;" v-if="permission===1">
            <a href="/static/src/modelfiles/PersonInfo.xlsx" style="color: orange;font-size: 16px">模板下载<img src="/static/src/back/document_save_2_24px_539656_easyicon.net.png" alt="..."></a>
            </div>
    </div>


     <div v-cloak class="fileUploadContent"    v-if="permission===1">

            <div class="inputPackage" v-cloak>
                 <span v-cloak>請選擇文件</span>
                 <input v-cloak type="file" id="upload" ref="file" @change="updateFile(event)" v-model="excelFile">
            </div>
         <el-button @click="fileUpload" type="warning" style="height:40px" v-cloak> Excel上傳</el-button>
          <span class="showFileName" v-cloak >${ fileName }</span>
          <el-checkbox label="存為歷史記錄" id="checking" style="line-height:40px;margin-left: 20px;color:white;font-size: 18px" @change="checking()"></el-checkbox>
          <el-date-picker for="historyYear" id="historyYear"  v-if="checkingResult==true" value-format="yyyy" v-model="lastyear" type="year" placeholder="選擇年份" style="margin-left: 20px;"></el-date-picker>

     </div>
          <br/>
         <el-button  type="danger" v-if="permission===1" @click="multiDelete" style="margin-left: 20px;">批量刪除</el-button>
         <el-button @click="appendData()" v-if="permission===1" v-cloak type="success" style="margin-left: 20px;">新增信息</el-button>
     <el-dialog :visible.sync="appendss">
           <template>
            <el-form ref="form"  :model="form" :rules="rules"  :label-position="labelPosition" label-width="130px">
                  <el-form-item label="狀態" prop="Status">
                        <el-select v-model="form.Status" placeholder="請選擇" >
                              <el-option label="在職" value="在職"></el-option>
                              <el-option label="離職" value="離職"></el-option>
                              <el-option label="轉部門" value="轉部門"></el-option>
                        </el-select>
                  </el-form-item>
                  <el-form-item label="報到日期" prop="RegistrationDate">
                         <el-date-picker v-model="form.RegistrationDate" value-format="yyyy-MM-dd" type="date" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                  <el-form-item label="预计離職日期">
                         <el-date-picker v-model="form.ExpectedDepartureDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                 <el-form-item label="離職日期">
                         <el-date-picker v-model="form.DepartureDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                  <el-form-item label="離職原因">
                         <el-select v-model="form.DepartureReasons" placeholder="請選擇" >
                              <el-option label="薪資福利" value="薪資福利"></el-option>
                              <el-option label="家庭因素" value="家庭因素"></el-option>
                              <el-option label="進修學習" value="進修學習"></el-option>
                              <el-option label="實習結束" value="實習結束"></el-option>
                              <el-option label="考公職" value="考公職"></el-option>
                         </el-select>
                  </el-form-item>
                  <el-form-item label="離職详情">
                          <el-input  v-model="form.DepartureDetails" ></el-input>
                  </el-form-item>
                 <el-form-item label="離職去向">
                         <el-select v-model="form.DepartureTo" placeholder="請選擇" >
                              <el-option label="1.同行" value="1.同行"></el-option>
                              <el-option label="2.同業" value="2.同業"></el-option>
                              <el-option label="3.外包測試" value="3.外包測試"></el-option>
                              <el-option label="4.公務員/事業單位" value="4.公務員/事業單位"></el-option>
                              <el-option label="5.其他" value="5.其他"></el-option>
                         </el-select>
                  </el-form-item>
                  <el-form-item label="新公司名稱">
                           <el-input v-model="form.NewCompanyName" ></el-input>
                  </el-form-item>
                  <el-form-item label="薪資">
                           <el-input v-model="form.Salary" ></el-input>
                  </el-form-item>
                 {% comment %}<el-form-item label="年資" prop="Seniority">
                           <el-input v-model="form.Seniority" ></el-input>
                  </el-form-item>{% endcomment %}
                 <el-form-item label="客戶" prop="Customer">
                           <el-select v-model="form.Customer" placeholder="请选择" >
                                <el-option v-for="item in Customeroptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="部門" prop="Department">
                           <el-select v-model="form.Department" placeholder="请选择" >
                                <el-option v-for="item in Departmentoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="課別" prop="Lesson">
                           <el-select v-model="form.Lesson" placeholder="请选择" >
                                <el-option v-for="item in Lessonoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="集團員工" prop="GroupEmployees">
                           <el-input v-model="form.GroupEmployees" ></el-input>
                  </el-form-item>
                 <el-form-item label="SAP員工">
                           <el-input v-model="form.SAPEmployees" ></el-input>
                  </el-form-item>
                 <el-form-item label="中文姓名" prop="ChineseName">
                           <el-input v-model="form.ChineseName" ></el-input>
                  </el-form-item>
                 <el-form-item label="英文姓名" prop="EnglishName">
                           <el-input v-model="form.EnglishName" ></el-input>
                  </el-form-item>
                 <el-form-item label="性別" prop="Gender">
                           <el-select v-model="form.Gender" placeholder="請選擇" >
                              <el-option label="男" value="男"></el-option>
                              <el-option label="女" value="女"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="現職稱" prop="CurrentTitle">
                          <el-select v-model="form.CurrentTitle" placeholder="请选择" >
                                <el-option v-for="item in Titleoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="最後一次晉升日期">
                          <el-date-picker v-model="form.LastPromotionDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                 <el-form-item label="入職職稱" prop="EntryTitle">
                           <el-select v-model="form.EntryTitle" placeholder="请选择" >
                                <el-option v-for="item in Titleoptions1" :key="item" :label="item.label" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="晉升次數" prop="PromotionNumber">
                             <el-select v-model="form.PromotionNumber">
                                 <el-option label="0" value="0"></el-option>
                                 <el-option label="1" value="1"></el-option>
                                 <el-option label="2" value="2"></el-option>
                                 <el-option label="3" value="3"></el-option>
                                 <el-option label="4" value="4"></el-option>
                                 <el-option label="5" value="5"></el-option>
                                 <el-option label="6" value="6"></el-option>
                                 <el-option label="7" value="7"></el-option>
                                 <el-option label="8" value="8"></el-option>
                                 <el-option label="9" value="9"></el-option>
                                 <el-option label="10" value="10"></el-option>
                             </el-select>
                  </el-form-item>
                 <el-form-item label="是否承認工作經驗" prop="WorkExperience">
                           <el-select v-model="form.WorkExperience">
                                 <el-option label="0" value="0"></el-option>
                                 <el-option label="1" value="1"></el-option>
                                 <el-option label="2" value="2"></el-option>
                                 <el-option label="3" value="3"></el-option>
                                 <el-option label="4" value="4"></el-option>
                                 <el-option label="5" value="5"></el-option>
                                 <el-option label="6" value="6"></el-option>
                                 <el-option label="7" value="7"></el-option>
                                 <el-option label="8" value="8"></el-option>
                                 <el-option label="9" value="9"></el-option>
                                 <el-option label="10" value="10"></el-option>
                                 <el-option label="11" value="11"></el-option>
                                 <el-option label="12" value="12"></el-option>
                                 <el-option label="13" value="13"></el-option>
                                 <el-option label="14" value="14"></el-option>
                                 <el-option label="15" value="15"></el-option>
                                 <el-option label="16" value="16"></el-option>
                                 <el-option label="17" value="17"></el-option>
                                 <el-option label="18" value="18"></el-option>
                                 <el-option label="19" value="19"></el-option>
                                 <el-option label="20" value="20"></el-option>
                             </el-select>
                  </el-form-item>
                 <el-form-item label="畢業年度" prop="GraduationYear">
                           <el-date-picker v-model="form.GraduationYear" type="year" value-format="yyyy" placeholder="選擇年度" ></el-date-picker>
                  </el-form-item>
                 <el-form-item label="學歷" prop="Education">
                           <el-select v-model="form.Education" placeholder="請選擇" >
                              <el-option label="本科" value="本科"></el-option>
                              <el-option label="大專" value="大專"></el-option>
                              <el-option label="中專" value="中專"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="學校" prop="School">
                           <el-input v-model="form.School"></el-input>
                  </el-form-item>
                 {% comment %}<el-form-item label="專業歸屬" prop="ProfessionAttribution">
                     <el-autocomplete
                          class="inline-input"
                          v-model="form.ProfessionAttribution"
                          ref="ProfessionAttribution"
                          :fetch-suggestions="querySearch"
                          placeholder="请输入專業歸屬"
                          @select="handleSelect"
                        ></el-autocomplete>
                  </el-form-item>{% endcomment %}
                 <el-form-item label="專業" prop="Profession">
                          <el-input v-model="form.Profession" ></el-input>
                  </el-form-item>
                 <el-form-item label="英語" prop="English">
                           <el-select v-model="form.English" placeholder="請選擇">
                              <el-option label="二級" value="二級"></el-option>
                              <el-option label="三級" value="三級"></el-option>
                              <el-option label="四級" value="四級"></el-option>
                              <el-option label="六級" value="六級"></el-option>
                              <el-option label="NA" value="NA"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="身份證號" prop="IdNumber">
                           <el-input v-model="form.IdNumber" ></el-input>
                  </el-form-item>
                 <el-form-item label="籍貫省份" prop="NativeProvince">
                           <el-select v-model="form.NativeProvince" placeholder="请选择" >
                                <el-option v-for="item in NativeProvinceoptions1" :key="item.value" :label="item.label" :value="item.value"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="籍貫縣市" prop="NativeCity">
                           <el-input v-model="form.NativeCity" ></el-input>
                  </el-form-item>
                 <el-form-item label="戶口省份" prop="HukouProvinces">
                           <el-select v-model="form.HukouProvinces" placeholder="请选择">
                                <el-option v-for="item in HukouProvincesoptions1" :key="item.value" :label="item.label" :value="item.value"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="戶口縣市" prop="HukouCity">
                           <el-input v-model="form.HukouCity" ></el-input>
                  </el-form-item>
                 <el-form-item label="手機號碼" prop="PhoneNumber">
                           <el-input v-model="form.PhoneNumber"></el-input>
                  </el-form-item>
                  <el-form-item label="Photo">
                        <el-upload
                          action="#"
                          list-type="picture-card"
                          :on-success="handleImageSuccess"
                          :before-upload="beforeImageUpload"
                          :auto-upload="true"
{#                          :file-list="fileListO"#}
                          >
                          <!-- 十字图标 -->
                          <i slot="default" class="el-icon-plus"></i>
                          <!-- 文件 -->
                          <div slot="file" slot-scope="{file}">
                            <img class="el-upload-list__item-thumbnail" :src="file.url" alt />
                            <video class="el-upload-list__item-thumbnail" :src="file.url" alt />
                            <span class="el-upload-list__item-actions">
                              <span class="el-upload-list__item-preview" @click="handlePictureCardPreview(file)">
                                <i class="el-icon-zoom-in"></i>
                              </span>
                            </span>
                          </div>
                        </el-upload>
                        <el-dialog :visible.sync="dialogVisible">
                            <img width="100%" :src="dialogImageUrl" alt />
                        </el-dialog>
                  </el-form-item>
                  <el-form-item>
                        <el-button type="primary" @click="onAppend(form)">確定</el-button>
                  </el-form-item>
             </el-form>
        </template>
     </el-dialog>
    <el-dialog :visible.sync="update">
        <template>
             <el-form ref="form"  :model="form"  :label-position="labelPosition" label-width="130px">
                  <el-form-item label="狀態">
                        <el-select v-model="form.Status" placeholder="請選擇" :disabled="!(permission===1)">
                              <el-option label="在職" value="在職"></el-option>
                              <el-option label="離職" value="離職"></el-option>
                              <el-option label="轉部門" value="轉部門"></el-option>
                        </el-select>
                  </el-form-item>
                  <el-form-item label="報到日期">
                         <el-date-picker v-model="form.RegistrationDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" :disabled="!(permission===1)"></el-date-picker>
                  </el-form-item>
                  <el-form-item label="预计離職日期">
                         <el-date-picker v-model="form.ExpectedDepartureDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                 <el-form-item label="離職日期">
                         <el-date-picker v-model="form.DepartureDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" ></el-date-picker>
                  </el-form-item>
                  <el-form-item label="離職原因">
                         <el-select v-model="form.DepartureReasons" placeholder="請選擇" :disabled="!(permission===1||permission===2)">
                              <el-option label="薪資福利" value="薪資福利"></el-option>
                              <el-option label="家庭因素" value="家庭因素"></el-option>
                              <el-option label="進修學習" value="進修學習"></el-option>
                              <el-option label="實習結束" value="實習結束"></el-option>
                              <el-option label="考公職" value="考公職"></el-option>
                         </el-select>
                  </el-form-item>
                  <el-form-item label="離職详情">
                          <el-input  v-model="form.DepartureDetails" :disabled="!(permission===1||permission===2)"></el-input>
                  </el-form-item>
                 <el-form-item label="離職去向">
                         <el-select v-model="form.DepartureTo" placeholder="請選擇" :disabled="!(permission===1||permission===2)">
                              <el-option label="1.同行" value="1.同行"></el-option>
                              <el-option label="2.同業" value="2.同業"></el-option>
                              <el-option label="3.外包測試" value="3.外包測試"></el-option>
                              <el-option label="4.公務員/事業單位" value="4.公務員/事業單位"></el-option>
                              <el-option label="5.其他" value="5.其他"></el-option>
                         </el-select>
                  </el-form-item>
                  <el-form-item label="新公司名稱">
                           <el-input v-model="form.NewCompanyName" :disabled="!(permission===1||permission===2)"></el-input>
                  </el-form-item>
                  <el-form-item label="薪資">
                           <el-input v-model="form.Salary" :disabled="!(permission===1||permission===2)"></el-input>
                  </el-form-item>
                 {% comment %}<el-form-item label="年資">
                           <el-input v-model="form.Seniority" :disabled="!(permission===1)"></el-input>
                  </el-form-item>{% endcomment %}
                 <el-form-item label="客戶">
                           <el-select v-model="form.Customer" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in Customeroptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="部門">
                           <el-select v-model="form.Department" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in Departmentoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="課別">
                           <el-select v-model="form.Lesson" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in Lessonoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="集團員工">
                           <el-input v-model="form.GroupEmployees" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="SAP員工">
                           <el-input v-model="form.SAPEmployees" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="中文姓名">
                           <el-input v-model="form.ChineseName" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="英文姓名">
                           <el-input v-model="form.EnglishName" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="性別">
                           <el-select v-model="form.Gender" placeholder="請選擇" :disabled="!(permission===1)">
                              <el-option label="男" value="男"></el-option>
                              <el-option label="女" value="女"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="現職稱">
                          <el-select v-model="form.CurrentTitle" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in Titleoptions1" :key="item" :label="item" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="最後一次晉升日期">
                          <el-date-picker v-model="form.LastPromotionDate" type="date" value-format="yyyy-MM-dd" placeholder="選擇日期" :disabled="!(permission===1)"></el-date-picker>
                  </el-form-item>
                 <el-form-item label="入職職稱">
                           <el-select v-model="form.EntryTitle" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in Titleoptions1" :key="item" :label="item.label" :value="item"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="晉升次數" prop="PromotionNumber">
                             <el-select v-model="form.PromotionNumber">
                                 <el-option label="0" value="0"></el-option>
                                 <el-option label="1" value="1"></el-option>
                                 <el-option label="2" value="2"></el-option>
                                 <el-option label="3" value="3"></el-option>
                                 <el-option label="4" value="4"></el-option>
                                 <el-option label="5" value="5"></el-option>
                                 <el-option label="6" value="6"></el-option>
                                 <el-option label="7" value="7"></el-option>
                                 <el-option label="8" value="8"></el-option>
                                 <el-option label="9" value="9"></el-option>
                                 <el-option label="10" value="10"></el-option>
                             </el-select>
                  </el-form-item>
                 <el-form-item label="是否承認工作經驗" prop="WorkExperience">
                           <el-select v-model="form.WorkExperience">
                                 <el-option label="0" value="0"></el-option>
                                 <el-option label="1" value="1"></el-option>
                                 <el-option label="2" value="2"></el-option>
                                 <el-option label="3" value="3"></el-option>
                                 <el-option label="4" value="4"></el-option>
                                 <el-option label="5" value="5"></el-option>
                                 <el-option label="6" value="6"></el-option>
                                 <el-option label="7" value="7"></el-option>
                                 <el-option label="8" value="8"></el-option>
                                 <el-option label="9" value="9"></el-option>
                                 <el-option label="10" value="10"></el-option>
                                 <el-option label="11" value="11"></el-option>
                                 <el-option label="12" value="12"></el-option>
                                 <el-option label="13" value="13"></el-option>
                                 <el-option label="14" value="14"></el-option>
                                 <el-option label="15" value="15"></el-option>
                                 <el-option label="16" value="16"></el-option>
                                 <el-option label="17" value="17"></el-option>
                                 <el-option label="18" value="18"></el-option>
                                 <el-option label="19" value="19"></el-option>
                                 <el-option label="20" value="20"></el-option>
                             </el-select>
                  </el-form-item>
                 <el-form-item label="畢業年度">
                           <el-date-picker v-model="form.GraduationYear" type="year" value-format="yyyy" placeholder="選擇年度" :disabled="!(permission===1)"></el-date-picker>
                  </el-form-item>
                 <el-form-item label="學歷">
                           <el-select v-model="form.Education" placeholder="請選擇" :disabled="!(permission===1)">
                              <el-option label="本科" value="本科"></el-option>
                              <el-option label="大專" value="大專"></el-option>
                              <el-option label="中專" value="中專"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="學校">
                           <el-input v-model="form.School" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="專業歸屬">
                           <el-autocomplete
                          class="inline-input"
                          v-model="form.ProfessionAttribution"
                          ref="ProfessionAttribution"
                          :fetch-suggestions="querySearch"
                          @select="handleSelect"
                        ></el-autocomplete>
                  </el-form-item>
                 <el-form-item label="專業">
                          <el-input v-model="form.Profession" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="英語">
                           <el-select v-model="form.English" placeholder="請選擇" :disabled="!(permission===1)">
                              <el-option label="二級" value="二級"></el-option>
                              <el-option label="三級" value="三級"></el-option>
                              <el-option label="四級" value="四級"></el-option>
                              <el-option label="六級" value="六級"></el-option>
                              <el-option label="NA" value="NA"></el-option>
                           </el-select>
                  </el-form-item>
                 <el-form-item label="身份證號" >
                           <el-input v-model="form.IdNumber" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="生日">
                           <el-input v-model="form.Birthday" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="籍貫省份">
                           <el-select v-model="form.NativeProvince" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in NativeProvinceoptions1" :key="item.value" :label="item.label" :value="item.value"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="籍貫縣市">
                           <el-input v-model="form.NativeCity" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="戶口省份">
                           <el-select v-model="form.HukouProvinces" placeholder="请选择" :disabled="!(permission===1)">
                                <el-option v-for="item in HukouProvincesoptions1" :key="item.value" :label="item.label" :value="item.value"></el-option>
                          </el-select>
                  </el-form-item>
                 <el-form-item label="戶口縣市">
                           <el-input v-model="form.HukouCity" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                 <el-form-item label="手機號碼" >
                           <el-input v-model="form.PhoneNumber" :disabled="!(permission===1)"></el-input>
                  </el-form-item>
                  <el-form-item label="Photo">
                        <el-upload
                          action="#"
                          list-type="picture-card"
                          :on-success="handleImageSuccess"
                          :before-upload="beforeImageUpload"
                          :auto-upload="true"
                          :file-list="fileListO"
                          :disabled="!(permission===1)" >
                          <!-- 十字图标 -->
                          <i slot="default" class="el-icon-plus"></i>
                          <!-- 文件 -->
                          <div slot="file" slot-scope="{file}">
                            <img class="el-upload-list__item-thumbnail" :src="file.url" alt />
                            <video class="el-upload-list__item-thumbnail" :src="file.url" alt />
                            <span class="el-upload-list__item-actions">
                              <span class="el-upload-list__item-preview" @click="handlePictureCardPreview(file)">
                                <i class="el-icon-zoom-in"></i>
                              </span>
                            </span>
                          </div>
                        </el-upload>
                        <el-dialog :visible.sync="dialogVisible">
                            <img width="100%" :src="dialogImageUrl" alt />
                        </el-dialog>
                  </el-form-item>
                  <el-form-item>
                        <el-button type="primary" @click="onSubmit">更新</el-button>
                  </el-form-item>
             </el-form>
        </template>
    </el-dialog>
  <div class="tableAround" v-cloak >
    <span  class="selectItem" v-cloak  v-if="showCustomer&&showDepartment&&showLesson">當前表格信息：${ showYear }/${ showCustomer }/${ showDepartment }/${ showLesson }/${ showGroupEmployees } </span>
    <el-table id="out-table"  height="700" border :data="tableContent.slice((currentPage -1 )*pageSize,(currentPage)*pageSize)"  style="min-width: 100%;border-radius: 10px"  @selection-change="handleSelectionChange" :row-key="getRowKeys" :header-cell-style="{'background-color':'#fafafa','font-weight':'800','border-bottom':'1px solid rgb(103, 194, 58)'}">
              <el-table-column type="selection" width="50" fixed></el-table-column>
              <el-table-column  label="Edit" fixed>
                  <template slot-scope="scope">
                      <el-button style="border:0;color: #D9B300" type="i" class="ti-pencil-alt"  @click="alertID(scope.row.id,scope.row)"></el-button>
                      </template>
              </el-table-column>
              <el-table-column type="index" :index="indexMethod" ></el-table-column>
                <el-table-column  prop="Customer" label="客戶別"  ></el-table-column>
                <el-table-column  prop="Department" label="部門"  ></el-table-column>
                <el-table-column  prop="Lesson" label="課別"  ></el-table-column>
                <el-table-column  prop="GroupEmployees" label="集團員工"  ></el-table-column>
                <el-table-column  prop="SAPEmployees" label="SAP員工"  ></el-table-column>
                <el-table-column  prop="ChineseName" label="中文姓名"  ></el-table-column>
                <el-table-column  prop="EnglishName" label="英文姓名"  ></el-table-column>
                <el-table-column  prop="Gender" label="性別"  ></el-table-column>
                <el-table-column  prop="Status" label="狀態"  ></el-table-column>
                <el-table-column  prop="RegistrationDate" label="報到日期"  ></el-table-column>
                <el-table-column  prop="ExpectedDepartureDate" label="预计離職日期"  ></el-table-column>
                <el-table-column  prop="DepartureDate" label="離職日期"  ></el-table-column>
                <el-table-column  prop="DepartureReasons" label="離職原因"  ></el-table-column>
                <el-table-column  prop="DepartureDetails" label="離職详情"  ></el-table-column>
                <el-table-column  prop="DepartureTo" label="離職去向"  ></el-table-column>
                <el-table-column  prop="NewCompanyName" label="新公司名稱"  ></el-table-column>
{#                <el-table-column  prop="Salary" label="薪資"  ></el-table-column>#}
                <el-table-column  prop="Seniority" label="年資"  ></el-table-column>
                <el-table-column  prop="CurrentTitle" label="現職稱"  ></el-table-column>
                <el-table-column  prop="LastPromotionDate" label="最近一次晉升日期"  ></el-table-column>
                <el-table-column  prop="EntryTitle" label="入職職稱"  ></el-table-column>
                <el-table-column  prop="PromotionNumber" label="晉升次數"  ></el-table-column>
{#                <el-table-column  prop="WorkExperience" label="是否承認工作經驗"  ></el-table-column>#}
                <el-table-column  prop="GraduationYear" label="畢業年度"  ></el-table-column>
                <el-table-column  prop="Education" label="學歷"  ></el-table-column>
                <el-table-column  prop="School" label="學校"  ></el-table-column>
{#                <el-table-column  prop="ProfessionAttribution" label="專業歸屬"  ></el-table-column>#}
                <el-table-column  prop="Profession" label="專業"  ></el-table-column>
                <el-table-column  prop="English" label="英語"  ></el-table-column>
                <el-table-column  prop="IdNumber" label="身份証號"  ></el-table-column>
                <el-table-column  prop="Birthday" label="生日"  ></el-table-column>
                <el-table-column  prop="NativeProvince" label="籍貫省份"  ></el-table-column>
                <el-table-column  prop="NativeCity" label="籍貫縣市"  ></el-table-column>
                <el-table-column  prop="HukouProvinces" label="戶口省份"  ></el-table-column>
                <el-table-column  prop="HukouCity" label="戶口縣市"  ></el-table-column>
                <el-table-column  prop="PhoneNumber" label="手機號碼"  ></el-table-column>
    </el-table>
      <div class="block">
        <el-pagination  @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="currentPage" :page-sizes="[10, 50, 100, 200]" :page-size="pageSize" layout="total, sizes, prev, pager, next, jumper" :total="totalNum">
        </el-pagination>
      </div>
  </div>
  </div>
{% endblock %}
{% block scripts %}
<script src="/static/js/es6/polyfill.min.js"></script>
<script src="/static/js/es6/babel.min.js"></script>
<script src="/static/js/axios.min.js"></script>
<script src="/static/js/vue.min.js"></script>
<script src="/static/js/qs.js"></script>
<script src="/static/js/Element/index.js"></script>
<script src="/static/js/xlsx/FileSaver.min.js"></script>
<script  src="/static/js/Element/table.js"></script>
<script  src="/static/js/Element/main.js"></script>
<script src="/static/js/Element/input.js"></script>
<script  src="/static/js/Element/table-column.js"></script>
<script src="/static/js/Element/icon.js"></script>
<script src="/static/js/Element/image.js"></script>
<script src="/static/js/Element/message.js"></script>
    <script type="text/babel">
    new Vue({
        el: '#app',
        delimiters: ['${', '}'],
        data: function () {
            return {
                loading:false,
                // 搜索条件
                year:'',
                yearOptions:[],
                GroupEmployeesNum:[],
                customer:'',
                customerOptions:{},
                customerError:false,
                department:'',
                departmentOptions:[],
                departmentError:false,
                lesson:'',
                lessonOptions:{},
                lessonError:false,
                groupemployees:'',
                groupemployeesOptions:[],
                groupemployeesError:false,
                tableContent:[],
                update:false,
                labelPosition:'right',
                 dialogImageUrl: '',
                dialogVisible: false,
                disabled: false,
                PhotoList:[],
                fileListO: [],
                  editID:'',
                form: {
                    Status: '',
                    RegistrationDate:'',
                    DepartureDate:'',
                    ExpectedDepartureDate:'',
                    DepartureReasons:'',
                    DepartureDetails:'',
                    DepartureTo:'',
                    NewCompanyName:'',
                    Salary:'',
                    Seniority:'',
                    Customer:'',
                    Department:'',
                    Lesson:'',
                    GroupEmployees:'',
                    SAPEmployees:'',
                    ChineseName:'',
                    EnglishName:'',
                    Gender:'',
                    CurrentTitle:'',
                    LastPromotionDate:'',
                    EntryTitle:'',
                    PromotionNumber:'',
                    WorkExperience:'',
                    GraduationYear:'',
                    Education:'',
                    School:'',
                    ProfessionAttribution:'',
                    Profession:'',
                    English:'',
                    IdNumber:'',
                    Birthday:'',
                    NativeProvince:'',
                    NativeCity:'',
                    HukouProvinces: '',
                    HukouCity: '',
                    PhoneNumber: '',
                },
                  formData:[],
                //form表單中需要從後台獲取的下拉選項
                Customeroptions1:[],
                Departmentoptions1:[],
                Lessonoptions1:[],
                Titleoptions1:[],   //職稱列表
                ProfessionAttributionoptions1:[],  //專業歸屬
                NativeProvinceoptions1:[{value: '北京市', label: '北京市'}, {value: '天津市', label: '天津市'}, {value: '上海市', label: '上海市'}, {value: '重慶市', label: '重慶市'}, {value: '內蒙古自治區', label: '內蒙古自治區'},{value: '新疆維吾爾自治區', label: '新疆維吾爾自治區'}, {value: '西藏自治區', label: '西藏自治區'},{value: '寧夏回族自治區', label: '寧夏回族自治區'}, {value: '廣西壯族自治區', label: '廣西壯族自治區'}, {value: '香港特別行政區', label: '香港特別行政區'}, {value: '澳門特別行政區', label: '澳門特別行政區'}, {value: '黑龍江省', label: '黑龍江省'},{value: '吉林省', label: '吉林省'},
                                            {value: '遼寧省', label: '遼寧省'},{value: '河北省', label: '河北省'}, {value: '山西省', label: '山西省'}, {value: '青海省', label: '青海省'}, {value: '山東省', label: '山東省'}, {value: '河南省', label: '河南省'},{value: '江蘇省', label: '江蘇省'}, {value: '安徽省', label: '安徽省'},{value: '浙江省', label: '浙江省'}, {value: '福建省', label: '福建省'}, {value: '江西省', label: '江西省'}, {value: '湖南省', label: '湖南省'}, {value: '湖北省', label: '湖北省'},{value: '廣東省', label: '廣東省'}, {value: '臺灣省', label: '臺灣省'},
                                        {value: '海南省', label: '海南省'},{value: '甘肅省', label: '甘肅省'}, {value: '陝西省', label: '陝西省'},{value: '四川省', label: '四川省'},{value: '貴州省', label: '貴州省'}, {value: '雲南省', label: '雲南省'}],
                HukouProvincesoptions1:[{value: '北京市', label: '北京市'}, {value: '天津市', label: '天津市'}, {value: '上海市', label: '上海市'}, {value: '重慶市', label: '重慶市'}, {value: '內蒙古自治區', label: '內蒙古自治區'},{value: '新疆維吾爾自治區', label: '新疆維吾爾自治區'}, {value: '西藏自治區', label: '西藏自治區'},{value: '寧夏回族自治區', label: '寧夏回族自治區'}, {value: '廣西壯族自治區', label: '廣西壯族自治區'}, {value: '香港特別行政區', label: '香港特別行政區'}, {value: '澳門特別行政區', label: '澳門特別行政區'}, {value: '黑龍江省', label: '黑龍江省'},{value: '吉林省', label: '吉林省'},
                                            {value: '遼寧省', label: '遼寧省'},{value: '河北省', label: '河北省'}, {value: '山西省', label: '山西省'}, {value: '青海省', label: '青海省'}, {value: '山東省', label: '山東省'}, {value: '河南省', label: '河南省'},{value: '江蘇省', label: '江蘇省'}, {value: '安徽省', label: '安徽省'},{value: '浙江省', label: '浙江省'}, {value: '福建省', label: '福建省'}, {value: '江西省', label: '江西省'}, {value: '湖南省', label: '湖南省'}, {value: '湖北省', label: '湖北省'},{value: '廣東省', label: '廣東省'}, {value: '臺灣省', label: '臺灣省'},
                                        {value: '海南省', label: '海南省'},{value: '甘肅省', label: '甘肅省'}, {value: '陝西省', label: '陝西省'},{value: '四川省', label: '四川省'},{value: '貴州省', label: '貴州省'}, {value: '雲南省', label: '雲南省'}],
                permission:null,//编辑权限
                loginLesson:null,
                //文件上傳
                excelFile:null,
                uploadFile:null,
                fileName:"未選擇文件",
                multiDeleteVisible:false,
                multipleSelection: [],
                //表格信息顯示
                showYear:'',
                showCustomer:'',
                showDepartment:'',
                showLesson:'',
                showGroupEmployees:'',
                //新增信息
                appendss:false,
                //分页
                currentPage: 1,//默认显示第一页
                pageSize:100,//默认每页显示100条
                totalNum: null,

                historyYear:'',
                checkingResult:false,
                errMsg:null,
                lastyear:null,
                 HistoryYear:null,
                 rules: {
                    Status: [
                         { required: true, message: "请输入狀態", trigger:['blur','change'] }
                      ],
                      RegistrationDate: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      {% comment %}Seniority: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],{% endcomment %}
                      Customer: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      Department: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      Lesson: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      GroupEmployees: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      ChineseName: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      EnglishName: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      Gender: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      CurrentTitle: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      EntryTitle: [
                         { required: true, message: "不能為空", trigger: ['blur','change'] }
                      ],
                      PromotionNumber: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      WorkExperience: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      GraduationYear: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      Education: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      School: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      ProfessionAttribution: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      Profession: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      English: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      IdNumber: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      NativeProvince: [
                         { required: true, message: "不能為空", trigger:['blur','change']}
                      ],
                      NativeCity: [
                         { required: true, message: "不能為空", trigger:['blur','change']}
                      ],
                      HukouProvinces: [
                         { required: true, message: "不能為空", trigger:['blur','change']}
                      ],
                      HukouCity: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ],
                      PhoneNumber: [
                         { required: true, message: "不能為空", trigger:['blur','change'] }
                      ]
                    },





            }
        },
        mounted(){        // 页面渲染后触发该区域内容 即页面初始化
            this.getdata("first");
        },
        methods: {
            //获取数据
            getdata: function (e) {
                this.Titleoptions1=[];
                let data = {"isGetData": e, "csrfmiddlewaretoken": $("[name='csrfmiddlewaretoken']").val()};
                axios.post("/PersonalInfo/PersonalInfo-edit/", Qs.stringify(data), {
                    headers: {'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                }).then((res) => {
                    this.customerOptions=res.data.select;
                    this.permission=res.data.permission;
                    this.loginLesson=res.data.loginLesson;
                    this.tableContent=res.data.content;
                    this.GroupEmployeesNum=res.data.GroupEmployeesNum;
                    this.totalNum=this.tableContent.length;

                    this.Customeroptions1=res.data.Customeroptions1;
                    this.Departmentoptions1=res.data.Departmentoptions1;
                    this.Lessonoptions1=res.data.Lessonoptions1;
                    this.Titleoptions1=res.data.Titleoptions1;
                    this.ProfessionAttributionoptions1=res.data.ProfessionAttributionoptions1;
                    //console.log(this.totalNum)
                 });
            },

         exportExcel: function () {
             /* 从表生成工作簿对象 */
             {#console.log(document.querySelector("#out-table"));#}
             let temp = [];
             temp.push(Number(this.currentPage));
             temp.push(Number(this.pageSize));
             {#console.log(temp);#}
             this.currentPage = 1;
             this.pageSize = this.tableContent.length;
             {#console.log(temp, this.defaultPage1, this.pageSize);#}
             setTimeout(() => {
                 let table = document.querySelector("#out-table").cloneNode(true);
                 let fix = table.querySelector(".el-table__fixed");
                 let wb;
                 if(fix){
                    wb = XLSX.utils.table_to_book(table.removeChild(fix),{raw: true});
                    table.appendChild(fix);
                 }else{
                    wb = XLSX.utils.table_to_book(table,{raw: true});
                 }
                 console.log("wb", wb);
                 /* 获取二进制字符串作为输出 */
                 var wbout = XLSX.write(wb, {
                     bookType: "xlsx",
                     bookSST: true,
                     type: "array"
                 });
                 console.log("wbout", wbout);
                 try {
                     saveAs(
                         //Blob 对象表示一个不可变、原始数据的类文件对象。
                         //Blob 表示的不一定是JavaScript原生格式的数据。
                         //File 接口基于Blob，继承了 blob 的功能并将其扩展使其支持用户系统上的文件。
                         //返回一个新创建的 Blob 对象，其内容由参数中给定的数组串联组成。
                         new Blob([wbout], {type: "application/octet-stream"}),
                         //设置导出文件名称
                         "sheetjs.xlsx"
                     );

                 } catch (e) {
                     if (typeof console !== "undefined") console.log(e, wbout);
                 }
                 this.currentPage = temp[0];
                 this.pageSize = temp[1];//edwin:要想导出后回到当前页而不是第一页，<el-pagination里面的:page-size="100"，而不能是:page-size="pageSize"
                 temp = [];
                 return wbout;
             }, 100);
         },


            //级联
            changeCustomer:function () {
                 if(this.$refs.Customer.value ==""){
                      this.departmentOptions=[""];
                      return false;
                 }
                 this.departmentOptions=this.customerOptions[this.$refs.Customer.value];
                 this.department="";
                 console.log(this.departmentOptions);
             },
            changeDepartment:function(index){
                if(this.$refs.Department.value ==""){
                      this.lessonOptions=[""];
                      return false;
                }
                let Year=this.$refs.Year.value;
                let Customer=this.$refs.Customer.value;
                let Department=this.$refs.Department.value;
                let data ={"isGetData":"JiLian","Year":Year,"Customer":Customer,"Department":Department,"csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val()}
               axios.post("/PersonalInfo/PersonalInfo-edit/",Qs.stringify(data), {
               headers:{ 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                }).then((res) => {
                    this.lessonOptions=res.data.lessonOptions;
                });
            },
    {% comment %}
            changeLesson:function(index){
                if(this.$refs.Lesson.value ==""){
                      this.groupemployeesOptions=[""];
                      return false;
                 }
                 this.groupemployeesOptions=this.lessonOptions[this.$refs.Lesson.value];
                 this.groupemployees="";
                 console.log(this.groupemployeesOptions);
            },
    {% endcomment %}
            //上传搜索项：以此选项搜索符合条件的内容
            find :function(){
                {% comment %}
                if(this.$refs.Customer.value ==""){
                      this.customerError= true;
                      return false;
                 }
                if(this.$refs.Department.value ==""){
                      this.departmentError= true;
                      return false;
                 }
                if(this.$refs.Lesson.value ==""){
                      this.lessonError= true;
                      return false;
                 }
                if(this.$refs.GroupEmployees.value ==""){
                      this.groupemployeesError= true;
                      return false;
                 }
                 {% endcomment %}
                this.Titleoptions1=[];
                let Year=this.$refs.Year.value;
                let Customer = this.$refs.Customer.value;
                let Department=this.$refs.Department.value;
                let Lesson = this.$refs.Lesson.value;
                let GroupEmployees = this.$refs.GroupEmployees.value;
               let data ={"isGetData":"SEARCH","Year":Year,"Customer":Customer,"Department":Department,"Lesson":Lesson,"GroupEmployees":GroupEmployees,"csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val()}
               axios.post("/PersonalInfo/PersonalInfo-edit/",Qs.stringify(data), {
               headers:{ 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                }).then((res) => {
                  this.tableContent=res.data.content;
                  this.totalNum=this.tableContent.length;
                  this.Titleoptions1=res.data.Titleoptions1;
                })
                       this.showYear=Year;
                       this.showCustomer=Customer;
                       this.showDepartment=Department;
                       this.showLesson=Lesson;
                       this.showGroupEmployees=GroupEmployees;
                       this.customerError= false;
                       this.departmentError= false;
                       this.lessonError= false;
                       this.groupemployeesError= false;

             },
            alertID:function(id,row){
                if(this.permission===1||(this.permission===2&&row.Lesson===this.loginLesson)){
                    this.update=true;
                    let Year=this.$refs.Year.value;
                    let Customer = this.$refs.Customer.value;
                    let Department=this.$refs.Department.value;
                    let Lesson = this.$refs.Lesson.value;
                    let GroupEmployees = this.$refs.GroupEmployees.value;
                    let msg = {
                      "isGetData" : "alertID" , "Year":Year,"Customer":Customer,"Department":Department,"Lesson":Lesson,"GroupEmployees":GroupEmployees,"ID":id
                  }
                   axios.post("/PersonalInfo/PersonalInfo-edit/",Qs.stringify(msg,{indices:false}),{
                            headers:{ 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8','X-CSRFToken':$("[name='csrfmiddlewaretoken']").val()} //改变头格式，原生默认上传json格式
                        } ).then((res) => {
                                        //console.log('row', row,row.fileListO,)
                                         this.form.Status=row.Status;
                                         if(row.RegistrationDate=='None'){
                                                this.form.RegistrationDate=''
                                            }else{
                                                this.form.RegistrationDate=row.RegistrationDate;
                                            }
                                            if(row.DepartureDate=='None'){
                                                this.form.DepartureDate=''
                                            }else{
                                                this.form.DepartureDate=row.DepartureDate;
                                            }
                                            if(row.ExpectedDepartureDate=='None'){
                                                this.form.ExpectedDepartureDate=''
                                            }else{
                                                this.form.ExpectedDepartureDate=row.ExpectedDepartureDate;
                                            }
                                         {% comment %}this.form.RegistrationDate=new Date(Date.parse(row.RegistrationDate.replace(/-/g,  "/")));
                                         this.form.DepartureDate=new Date(Date.parse(row.DepartureDate.replace(/-/g,  "/")));
                                         this.form.ExpectedDepartureDate=new Date(Date.parse(row.ExpectedDepartureDate.replace(/-/g,  "/")));{% endcomment %}
                                         this.form.DepartureReasons=row.DepartureReasons;
                                         this.form.DepartureDetails=row.DepartureDetails;
                                         this.form.DepartureTo=row.DepartureTo;
                                         this.form.NewCompanyName=row.NewCompanyName;
                                         this.form.Salary=row.Salary;
                                         this.form.Seniority=row.Seniority;
                                         this.form.Customer=row.Customer;
                                         this.form.Department=row.Department;
                                         this.form.Lesson=row.Lesson;
                                         this.form.GroupEmployees=row.GroupEmployees;
                                         this.form.SAPEmployees=row.SAPEmployees;
                                         this.form.ChineseName=row.ChineseName;
                                         this.form.EnglishName=row.EnglishName;
                                         this.form.Gender=row.Gender;
                                         this.form.CurrentTitle=row.CurrentTitle;
                                         if(row.LastPromotionDate=='None'){
                                                this.form.LastPromotionDate=''
                                            }else{
                                                this.form.LastPromotionDate=row.LastPromotionDate;
                                            }
                                         {#this.form.LastPromotionDate=new Date(Date.parse(row.LastPromotionDate.replace(/-/g,  "/")));#}
                                         this.form.EntryTitle=row.EntryTitle;
                                         this.form.PromotionNumber=row.PromotionNumber;
                                         this.form.WorkExperience=row.WorkExperience;
                                         this.form.GraduationYear=row.GraduationYear;
                                         this.form.Education=row.Education;
                                         this.form.School=row.School;
                                         this.form.ProfessionAttribution=row.ProfessionAttribution;
                                         this.form.Profession=row.Profession;
                                         this.form.English=row.English;
                                         this.form.IdNumber=row.IdNumber;
                                         this.form.Birthday=row.Birthday;
                                         this.form.NativeProvince=row.NativeProvince;
                                         this.form.NativeCity=row.NativeCity;
                                         this.form.HukouProvinces=row.HukouProvinces;
                                         this.form.HukouCity=row.HukouCity;
                                         this.form.PhoneNumber=row.PhoneNumber;
                                         this.fileListO = row.fileListO;

                                                           this.editID = id;
                                       //this.fileListO = res.data.fileListO;
                                       this.Customeroptions1=res.data.Customeroptions1;
                                       this.Departmentoptions1=res.data.Departmentoptions1;
                                       this.Lessonoptions1=res.data.Lessonoptions1;
                                       //this.Titleoptions1=res.data.Titleoptions1;
                                       this.ProfessionAttributionoptions1=res.data.ProfessionAttributionoptions1;


                   })
                    }else{
                           this.update=false;
                           this.$message({
                              showClose: true,
                              message: '只能編輯本課別人員的信息',
                              type: 'warning'
                            });
                   }
            },
            indexMethod(index) {
                  return index +1;
            },
            handleRemove(file) {
              // 删除文件
                  console.log(file.response.data);
                  let fileNames = file.response.data.split("/");
                  fileDelete(fileNames[fileNames.length - 1]).then(res => {
                    if (res.data.code == "0000") {
                      this.fileList.splice(file, 1);
                    }
               });
            },
            handlePictureCardPreview(file) {
                  // 预览文件
                  this.dialogImageUrl = file.url;
                  this.dialogVisible = true;
            },
            handleDownload(file) {
                  console.log("下载成功");
                  let fileNames = file.response.data.split("/");
                  let fileName = fileNames[fileNames.length - 1];
                  fileDownload(fileName).then(res => {
                    if (res.data.code == "0000") {
                        this.downloadFile(fileName,res.data.data);
                    }
                  });
            },
            handleImageSuccess(res, files, fileList) {
                  // 上传成功
                  this.formData = new FormData();
                  this.fileList = fileList;
                  console.log("上传成功" + fileList.length,files,"tt",fileList);
                  for(var i=0; i<this.fileList.length; i++){
                        this.formData.append('fileList', fileList[i].raw)//fileList里面raw才是文件对象，与files一样
                  }
                 console.log(this.formData,typeof (this.formData))
            },
            beforeImageUpload(file) {
              // 上传前格式与大小校验
                console.log(file,file.type)
              const isJPG = file.type === "image/jpeg"|| file.type == 'image/png'|| file.type == 'video/mp4'|| file.type == 'application/pdf'|| file.type == 'application/x-zip-compressed'|| file.type == ''|| file.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
              const isLt2M = file.size / 1024 / 1024 < 5;

              if (!isJPG) {
                this.$message.error("上传头像图片只能是 JPG/PNG 格式，视频为mp4格式!");
              }
              if (!isLt2M) {
                this.$message.error("上传头像图片大小不能超过 5MB!");
              }
              return isJPG && isLt2M;
                console.log("before" )
                //也是成功的
            },
            // 下载
            downloadFile(fileName, content) {
              let aLink = document.createElement("a");
              let blob = this.base64ToBlob(content); //new Blob([content]);

              let evt = document.createEvent("HTMLEvents");
              evt.initEvent("click", true, true); // initEvent 不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为
              aLink.download = fileName;
              aLink.href = URL.createObjectURL(blob);

              // aLink.dispatchEvent(evt);
              aLink.click();
            },
            // base64转blob
            base64ToBlob(code) {
              let parts = code.split(";base64,");
              let contentType = parts[0].split(":")[1];
              let raw = window.atob(parts[1]);
              let rawLength = raw.length;

              let uInt8Array = new Uint8Array(rawLength);

              for (let i = 0; i < rawLength; ++i) {
                uInt8Array[i] = raw.charCodeAt(i);
              }
              return new Blob([uInt8Array], { type: contentType });
            },
            zhuanhuangeshi(TZH){


                    let A =TZH.getFullYear();
                    let B =TZH.getMonth()+1;
                    let C =TZH.getDate();

                    return A+'-'+B+'-'+C;
            },
            onSubmit() {
                console.log('submit!',this.$refs.form.model,typeof (this.$refs.form.model),this.formData);
                {#var submitData = new FormData();#}
                if (this.formData.length==0){this.formData = new FormData();}
                this.formData.append('searchYear', this.$refs.Year.value)
                this.formData.append('searchCustomer', this.$refs.Customer.value)
                this.formData.append('searchDepartment', this.$refs.Department.value)
                this.formData.append('searchLesson', this.$refs.Lesson.value)
                this.formData.append('searchGroupEmployees', this.$refs.GroupEmployees.value)
                this.formData.append('id', this.editID)
                this.formData.append('Status', this.$refs.form.model.Status)
                if(this.$refs.form.model.RegistrationDate instanceof Date){
                      this.formData.append('RegistrationDate', this.zhuanhuangeshi(this.$refs.form.model.RegistrationDate))
                }else{
                      this.formData.append('RegistrationDate', this.$refs.form.model.RegistrationDate)
                }
                if(this.$refs.form.model.DepartureDate instanceof Date){
                      this.formData.append('DepartureDate', this.zhuanhuangeshi(this.$refs.form.model.DepartureDate))
                }else{
                      this.formData.append('DepartureDate', this.$refs.form.model.DepartureDate)
                }
                if(this.$refs.form.model.ExpectedDepartureDate instanceof Date){
                      this.formData.append('ExpectedDepartureDate', this.zhuanhuangeshi(this.$refs.form.model.ExpectedDepartureDate))
                }else{
                      this.formData.append('ExpectedDepartureDate', this.$refs.form.model.ExpectedDepartureDate)
                }
                this.formData.append('DepartureReasons', this.$refs.form.model.DepartureReasons)
                this.formData.append('DepartureDetails', this.$refs.form.model.DepartureDetails)
                this.formData.append('DepartureTo', this.$refs.form.model.DepartureTo)
                this.formData.append('NewCompanyName', this.$refs.form.model.NewCompanyName)
                this.formData.append('Salary', this.$refs.form.model.Salary)
                this.formData.append('Seniority', this.$refs.form.model.Seniority)
                this.formData.append('Customer', this.$refs.form.model.Customer)
                this.formData.append('Department', this.$refs.form.model.Department)
                this.formData.append('Lesson', this.$refs.form.model.Lesson)
                this.formData.append('GroupEmployees', this.$refs.form.model.GroupEmployees)
                this.formData.append('SAPEmployees', this.$refs.form.model.SAPEmployees)
                this.formData.append('ChineseName', this.$refs.form.model.ChineseName)
                this.formData.append('EnglishName', this.$refs.form.model.EnglishName)
                this.formData.append('Gender', this.$refs.form.model.Gender)
                this.formData.append('CurrentTitle', this.$refs.form.model.CurrentTitle)
                if(this.$refs.form.model.LastPromotionDate instanceof Date){
                      this.formData.append('LastPromotionDate', this.zhuanhuangeshi(this.$refs.form.model.LastPromotionDate))
                }else{
                      this.formData.append('LastPromotionDate', this.$refs.form.model.LastPromotionDate)
                }
                this.formData.append('EntryTitle', this.$refs.form.model.EntryTitle)
                this.formData.append('PromotionNumber', this.$refs.form.model.PromotionNumber)
                this.formData.append('WorkExperience', this.$refs.form.model.WorkExperience)
                this.formData.append('GraduationYear', this.$refs.form.model.GraduationYear)
                this.formData.append('Education', this.$refs.form.model.Education)
                this.formData.append('School', this.$refs.form.model.School)
                this.formData.append('ProfessionAttribution', this.$refs.form.model.ProfessionAttribution)
                this.formData.append('Profession', this.$refs.form.model.Profession)
                this.formData.append('English', this.$refs.form.model.English)
                this.formData.append('IdNumber', this.$refs.form.model.IdNumber)
                this.formData.append('Birthday', this.$refs.form.model.Birthday)
                this.formData.append('NativeProvince', this.$refs.form.model.NativeProvince)
                this.formData.append('NativeCity', this.$refs.form.model.NativeCity)
                this.formData.append('HukouProvinces', this.$refs.form.model.HukouProvinces)
                this.formData.append('HukouCity', this.$refs.form.model.HukouCity)
                this.formData.append('PhoneNumber', this.$refs.form.model.PhoneNumber)

                this.formData.append("action",'submit');
                console.log(this.formData)
                axios.post("/PersonalInfo/PersonalInfo-edit/", this.formData,{
                            headers:{ 'Content-Type': 'multipart/form-data','X-CSRFToken':$("[name='csrfmiddlewaretoken']").val()} //改变头格式，原生默认上传json格式
                        }).then((res)=>{
                            this.tableContent = res.data.content;
                            this.update=false;
                            this.formData = new FormData();

                })
            },
            updateFile:function(e){
            const first="未選擇文件";
            let newValue= e.target.files;
            if(newValue){
             let file=document.getElementById('upload');
             let filename= file.files[0].name;
             let fileType=filename.substr(filename.lastIndexOf(".")+1);
             console.log(fileType.toLowerCase());
             if((fileType.toLowerCase() === 'xlsx')||(fileType.toLowerCase() === 'xls')){
                  //console.log(this.excelFile);
                 this.fileName=filename;
                 this.uploadFile=file.files[0];
             }else{
                 alert("上傳類型不為'xlsx'或'xls'");
                   try{
                     }catch(e){
                         console.log(e);
                     }
             }
         }else{
             this.uploadFile=null;
             this.fileName=first;
         }
      },
            fileUpload:function(){
              const first="未選擇文件";
              if(this.uploadFile){
                  //1.解析Excel
                   let outputResult;
                   let _this= this;
                   let files = this.uploadFile;
                   let undefined_to_null=function(value){
                       if(value == undefined){
                           value=null;
                       }
                       //console.log(value,value === undefined,value == undefined);
                       return value;
                   }
                   var fileReader = new FileReader ();
                   const loading = this.$loading({
                              lock: true,
                              text: 'Loading',
                              spinner: 'el-icon-loading',
                              background: 'rgba(0, 0, 0, 0.7)'
                            });
                   fileReader.onload = function (ev) {
                     try {
                    // _this.loading=true;
                     var data = ev.target.result,
                      workbook = XLSX.read(data, {
                        type: 'binary'
                     }), // 以二进制流方式读取得到整份excel表格对象
                      persons = []; // 存储获取到的数据
                   } catch (e) {
                     //_this.loading=false;
                         loading.close();
                     return;
                  }
                  for (var sheet in workbook.Sheets) {
                if (workbook.Sheets.hasOwnProperty(sheet)) {
                    var fromTo = workbook.Sheets[sheet]['!ref'];
                    // console.log(fromTo);
                    var datas = workbook.Sheets[sheet];
                    // 如果有不规范数据可以在这里进行处理datas
                    persons = persons.concat(XLSX.utils.sheet_to_json(datas));
                    //break; // 只读了第一张表
                }
            }
                 // 数据保存在result
                  let result=JSON.stringify(persons);
                   //将之前张开的树形结构收起
                      //_this.reset();
                   //2.上傳數據
                       console.log(_this.lastyear instanceof Date)
                       if(_this.lastyear instanceof Date) {
                           _this.HistoryYear = _this.lastyear.getFullYear();
                       }else{
                           _this.HistoryYear = _this.lastyear;
                       }
                    axios.post("/PersonalInfo/PersonalInfo-edit/" ,{"Year":_this.year,"Customer":_this.showCustomer,"Department":_this.showDepartment,"Lesson":_this.showLesson,'GroupEmployees':_this.showGroupEmployees,"ExcelData":result,"historyYear":_this.HistoryYear},{
                    headers:{ 'X-CSRFToken':$("[name='csrfmiddlewaretoken']").val()} //改变头格式，原生默认上传json格式 ==>'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8',
                }).then((res) => {
                    //console.log(res.data,"first");//上传成功的操作
                        _this.tableContent=res.data.content;
                      _this.totalNum=_this.tableContent.length;
                      _this.errMsg=res.data.errMsg;
                    _this.uploadFile=null;
                    _this.fileName=first;
                   //_this.loading=false;
                        loading.close();
                    //上传成功的操作
                        if(_this.errMsg){
                            _this.$alert(_this.errMsg, '提示', {
                                  type: 'warning',
                                })
                        }else {
                            _this.$message({
                                message: '上傳成功',
                                type: 'success',
                            })
                        }
                    //接受数据的初始化
                    try{
                    }catch(e)
                    {
                       console.log("错误异常"+e);
                    }
                }).catch(function (e) {
                        //_this.loading=false;
                        loading.close();
                        _this.uploadFile=null;
                        var warning =confirm("上傳異常");
                        console.log("上傳錯誤信息"+e);
                    });
           };
                   try{
                   //console.log(fileReader.onload());
                   fileReader.readAsBinaryString(files);
                   //console.log(fileReader.readAsBinaryString(files));
                   }
                   catch(e){
                         //this.loading=false;
                       loading.close();
                         console.log(e);
                         alert("文件上傳異常") ;
                         return;
                    }
                  //console.log(outputResult);

             }else{
              //this.loading=false;
                  loading.close();
              alert("未選擇文件");
              return false;
          }
      },
            handleSelectionChange(rows) {
                this.multipleSelection = rows;
            },
            getRowKeys (row) {
              return row.id
            },
            multiDelete() {
                var warning=confirm('此操作将永久删除该条数据, 是否继续?')
                 if(warning) {
                     this.multiDeleteVisible = false;
                     let checkArr = this.multipleSelection;   // multipleSelection存储了勾选到的数据
                     let params = [];
                     let self = this;
                     checkArr.forEach(function (item) {
                         console.log(item);
                         params.push(item.id);       // 添加所有需要删除数据的id到一个数组，post提交过去
                     });
                     console.log(params);
                        let Year=this.$refs.Year.value;
                        let Customer = this.$refs.Customer.value;
                        let Department=this.$refs.Department.value;
                        let Lesson = this.$refs.Lesson.value;
                        let GroupEmployees = this.$refs.GroupEmployees.value;
                     let data = {
                         "isGetData": "MUTIDELETE",
                         "params": params,
                         "Year":Year,"Customer":Customer,"Department":Department,"Lesson":Lesson,"GroupEmployees":GroupEmployees,
                         "csrfmiddlewaretoken": $("[name='csrfmiddlewaretoken']").val()
                     };
                     axios.post('/PersonalInfo/PersonalInfo-edit/', data).then((res) =>{

                             this.tableContent = res.data.content;
                             this.totalNum=this.tableContent.length;

                             self.$message({
                                 message: '删除成功',
                                 type: 'success'
                             });
                         this.customerOptions=res.data.select;
                         this.permission=res.data.permission;
                     })
                 }else{
                     return false;
                 }
        },
            appendData(){
                    this.form={};
                    this.appendss=true;
                    let Year=this.$refs.Year.value;
                    let Customer = this.$refs.Customer.value;
                    let Department=this.$refs.Department.value;
                    let Lesson = this.$refs.Lesson.value;
                    let GroupEmployees = this.$refs.GroupEmployees.value;
                    let msg = {
                      "isGetData" : "appendData" , "Year":Year,"Customer":Customer,"Department":Department,"Lesson":Lesson,"GroupEmployees":GroupEmployees,
                  }
                   axios.post("/PersonalInfo/PersonalInfo-edit/",Qs.stringify(msg),{
                            headers:{ 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8','X-CSRFToken':$("[name='csrfmiddlewaretoken']").val()} //改变头格式，原生默认上传json格式
                        } ).then((res) => {
                                       this.Customeroptions1=res.data.Customeroptions1;
                                       this.Departmentoptions1=res.data.Departmentoptions1;
                                       this.Lessonoptions1=res.data.Lessonoptions1;
                                       this.Titleoptions1=res.data.Titleoptions1;
                                       this.ProfessionAttributionoptions1=res.data.ProfessionAttributionoptions1;
                   })
            },
            onAppend(){
                    if (this.formData.length==0){this.formData = new FormData();}
                this.formData.append('searchYear', this.$refs.Year.value)
                this.formData.append('searchCustomer', this.$refs.Customer.value)
                this.formData.append('searchDepartment', this.$refs.Department.value)
                this.formData.append('searchLesson', this.$refs.Lesson.value)
                this.formData.append('searchGroupEmployees', this.$refs.GroupEmployees.value)
                this.formData.append('id', this.editID)
                this.formData.append('Status', this.$refs.form.model.Status)
                this.formData.append('RegistrationDate', this.$refs.form.model.RegistrationDate)
                this.formData.append('DepartureDate', this.$refs.form.model.DepartureDate)
                this.formData.append('ExpectedDepartureDate', this.$refs.form.model.ExpectedDepartureDate)
                this.formData.append('DepartureReasons', this.$refs.form.model.DepartureReasons)
                this.formData.append('DepartureDetails', this.$refs.form.model.DepartureDetails)
                this.formData.append('DepartureTo', this.$refs.form.model.DepartureTo)
                this.formData.append('NewCompanyName', this.$refs.form.model.NewCompanyName)
                this.formData.append('Salary', this.$refs.form.model.Salary)
                this.formData.append('Seniority', this.$refs.form.model.Seniority)
                this.formData.append('Customer', this.$refs.form.model.Customer)
                this.formData.append('Department', this.$refs.form.model.Department)
                this.formData.append('Lesson', this.$refs.form.model.Lesson)
                this.formData.append('GroupEmployees', this.$refs.form.model.GroupEmployees)
                this.formData.append('SAPEmployees', this.$refs.form.model.SAPEmployees)
                this.formData.append('ChineseName', this.$refs.form.model.ChineseName)
                this.formData.append('EnglishName', this.$refs.form.model.EnglishName)
                this.formData.append('Gender', this.$refs.form.model.Gender)
                this.formData.append('CurrentTitle', this.$refs.form.model.CurrentTitle)
                this.formData.append('LastPromotionDate', this.$refs.form.model.LastPromotionDate)
                this.formData.append('EntryTitle', this.$refs.form.model.EntryTitle)
                this.formData.append('PromotionNumber', this.$refs.form.model.PromotionNumber)
                this.formData.append('WorkExperience', this.$refs.form.model.WorkExperience)
                this.formData.append('GraduationYear', this.$refs.form.model.GraduationYear)
                this.formData.append('Education', this.$refs.form.model.Education)
                this.formData.append('School', this.$refs.form.model.School)
                this.formData.append('ProfessionAttribution', this.$refs.form.model.ProfessionAttribution)
                this.formData.append('Profession', this.$refs.form.model.Profession)
                this.formData.append('English', this.$refs.form.model.English)
                this.formData.append('IdNumber', this.$refs.form.model.IdNumber)
                this.formData.append('Birthday', this.$refs.form.model.Birthday)
                this.formData.append('NativeProvince', this.$refs.form.model.NativeProvince)
                this.formData.append('NativeCity', this.$refs.form.model.NativeCity)
                this.formData.append('HukouProvinces', this.$refs.form.model.HukouProvinces)
                this.formData.append('HukouCity', this.$refs.form.model.HukouCity)
                this.formData.append('PhoneNumber', this.$refs.form.model.PhoneNumber)
                this.formData.append("action",'onAppend');
                console.log(this.formData)
                axios.post("/PersonalInfo/PersonalInfo-edit/", this.formData,{
                            headers:{ 'Content-Type': 'multipart/form-data','X-CSRFToken':$("[name='csrfmiddlewaretoken']").val()} //改变头格式，原生默认上传json格式
                        }).then((res)=>{
                            this.tableContent = res.data.content;
                            this.totalNum=this.tableContent.length;
                            this.appendss=false;
                            this.formData = new FormData();

                })
            },
            //分页
            handleSizeChange(val) {
                  //console.log(`每页 ${val} 条`);
                    this.pageSize = val;
            },
            handleCurrentChange(val) {
                //console.log(`当前页: ${val}`);
                  this.currentPage = val;
                  //console.log(this.tableContent.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize));
            },
            checking(){
                this.checkingResult=event.target.checked;
                 let a =new Date().getFullYear()-1;
                     let b =new Date().getMonth()+1;
                      let c =new Date().getDate();

                    let d=a+'-'+b+'-'+c;
                    this.lastyear=new Date(Date.parse(d.replace(/-/g,  "/")))
                    console.log(this.lastyear,'123')
                console.log(event.target.checked)
            },
            //模糊匹配

          querySearchGroupEmployee(queryString, cb) {
            var GroupEmployeesNum = this.GroupEmployeesNum;
            var results = queryString ? GroupEmployeesNum.filter(this.createFilter(queryString)) : GroupEmployeesNum;
            // 调用 callback 返回建议列表的数据
            cb(results);
          },

            querySearch(queryString,cb) {
                var ProfessionAttributionoptions1 = this.ProfessionAttributionoptions1;
                //console.log(queryString,'p1');
                var results = queryString ? ProfessionAttributionoptions1.filter(this.createFilter(queryString)) : ProfessionAttributionoptions1;
                // 调用 callback 返回建议列表的数据
                cb(results);
              },
              createFilter(queryString) {
                    {#console.log(queryString,'p2');#}
                return (restaurant) => {
                  return (
                      {#console.log(restaurant),#}
                      restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);
                };
              },
              handleSelect(item) {
                //console.log(item);
              },



        }
    })
    </script>
{% endblock %}















{% comment %}
{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}MQM_edit{% endblock %}
{% block css %}
<link rel="stylesheet" href="/static/css/index.css">
    <style>
.content{
    width:25px;
    height: 70px;
    position: fixed;
    right: 10px;
    top:60px;
    background-color:#343957;
    color:white;
    font-size: 20px;
    text-align: center;
    margin: 0 auto;
    word-wrap: break-word;
    line-height: 24px;
    writing-mode: vertical-lr;
    z-index: 99;
    opacity: 0.9;
}
    #container-yansebiaoshi{
    display:none;
    position: fixed;
    right: 35px;
    top:60px;
    z-index: 99;
    border: 2px solid  #deb887;
}
    .el-pagination__total,.el-pagination__jump{
        color:white;
    }
    .gutter{
        display:block!important;
        width:17px!important;
    }
    .cell-green{
    background: greenyellow;
}
    </style>
{% endblock %}
{% block content %}
    <div class="content" id="yincang">spec</div>
    <div id="container-yansebiaoshi">
    <img src="/static/images/spec.png">
    </div>
<div id="app">
<div class="row" style="white-space: nowrap;">
                    <div class="col-md-3">
                    <label style="color: #FFF" for="Customer">Customer</label>
           <select id="Customer" ref="Customer"  @change="changeCustomer" v-model="selectedCustomer" style="height:30px;width:100px;border-radius:5px 5px 5px 5px;">
               <option value="">All</option>
               <option v-for="(item,key,index) in selectItem" >${ key }</option>
           </select>
                    </div>
                    <div class="col-md-3">
                        　<label style="color: #FFF" for="Project">Project</label>
           <select id="Project" ref="Project"  @change="changeProject" v-model="selectedProject" style="height:30px;border-radius:5px 5px 5px 5px;width:100px;">
               <option value="">All</option>
               <option v-for="(item,key,index) in selectProject">${ item.Project }</option>
           </select>
                    </div>
                    <div class="col-md-1">
                        <el-button size="small" style="background:#428bca;color:#fff;" value="Search" name="Search" @click="selectMsg">Search</el-button>
                    </div>
                  <div class="col-md-1">
                    <el-button size="small" type="danger" v-if="statu === 4 || statu === 6" @click="multiDelete">批量删除</el-button>
                  </div>
          </div>
<template>
    <el-input v-model="search" placeholder="请输入内容模糊搜索"></el-input>
    <el-table border height="750" ref="multipleTable" @selection-change="handleSelectionChange" :row-key="getRowKeys" :data="tableContent.slice((currentPage-1)*pageSize,currentPage*pageSize)"
    :cell-style="addClass">
        <el-table-column type="selection" width="50" fixed></el-table-column>
        <el-table-column type="index" :index="indexMethod" fixed></el-table-column>
        <el-table-column label="Project" align="center" width="120" fixed>
            <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Project"></el-input>
                <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ project[scope.$index+(currentPage-1)*pageSize] }</span>
       </template>
        </el-table-column>
        <el-table-column label="Category" align="center" width="156" fixed>
            <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Category"></el-input>
                <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ category[scope.$index+(currentPage-1)*pageSize] }</span>
       </template>
        </el-table-column>
        <el-table-column label="Name" align="center" width="156" fixed>
            <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Name"></el-input>
                <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ name[scope.$index+(currentPage-1)*pageSize] }</span>
       </template>
        </el-table-column>
        <el-table-column label="Vendor" align="center" fixed>
            <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Vendor"></el-input>
                <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ vendor[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column  label="B for DQA" align="center">
            <el-table-column label="D/C" width="100" align="center">
                <template slot-scope="scope">
                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.DataCodeB"></el-input>
                      <span  v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ datacodeb[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Result" width="100" align="center">
                <template slot-scope="scope">
                    <span v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ scope.row.ResultforB }</span>
                     <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ resultforb[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Rel." width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"  @change="changeresultB(scope.row,scope.$index)"  v-model="scope.row.ReliabilityB">
                           <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ reliabilityb[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Com." width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 5 || statu === 4)"  @change="changeresultB(scope.row,scope.$index)"  v-model="scope.row.CompatibilityB">
                          <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 5 || statu === 4)">${ compatibilityb[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>

        </el-table-column>
{#        <el-table-column  label="B for RD" align="center">#}
{#            <el-table-column label="ESD" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.ESDB"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ esdb[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="EMI" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.EMIB"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ emib[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="RF" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.RFB"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ rfb[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#        </el-table-column>#}
        <el-table-column label="C for DQA" align="center" align="center" >
            <el-table-column label="D/C" width="100" align="center">
                <template slot-scope="scope">
                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.DataCodeC"></el-input>
                      <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ datacodec[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
                        <el-table-column label="Result" width="100" align="center">
                <template slot-scope="scope">
                    <span v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ scope.row.ResultforC }</span>
                      <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ resultforc[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>

            <el-table-column label="Rel." width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"  @change="changeresultC(scope.row,scope.$index)"  v-model="scope.row.ReliabilityC">
                          <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ reliabilityc[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Com." width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 5 || statu === 4)"  @change="changeresultC(scope.row,scope.$index)"  v-model="scope.row.CompatibilityC">
                          <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 5 || statu === 4)">${ compatibilityc[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
        </el-table-column>
{#        <el-table-column label="C for RD" align="center">#}
{#            <el-table-column label="ESD" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.ESDC"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ esdc[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="EMI" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.EMIC"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ emic[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="RF" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.RFC"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ rfc[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#        </el-table-column>#}
        <el-table-column label="INV for DQA" align="center" align="center" >
            <el-table-column label="Data Code" width="100" align="center">
                <template slot-scope="scope">
                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 4||statu === 7)"    v-model="scope.row.DataCodeINV"></el-input>
                      <span v-else="showEdit[scope.$index] && (statu === 4||statu === 7)">${ datacodeinv[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Result for INV" width="110" align="center">
                <template slot-scope="scope">
                    <span v-if="showEdit[scope.$index] && (statu === 4||statu === 7)">${ scope.row.ResultforINV }</span>
                      <span v-else="showEdit[scope.$index] && (statu === 4||statu === 7)">${ resultforinv[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Reliability" width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 7 || statu === 4)"  @change="changeresultINV(scope.row,scope.$index)"  v-model="scope.row.ReliabilityINV">
                          <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 7 || statu === 4)">${ reliabilityinv[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>
            <el-table-column label="Compatibility" width="110" align="center">
                <template slot-scope="scope">
                      <el-select class="edit-cell" v-if="showEdit[scope.$index] && (statu === 7 || statu === 4)"  @change="changeresultINV(scope.row,scope.$index)"  v-model="scope.row.CompatibilityINV">
                          <el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value"></el-option>
                      </el-select>
                      <span v-else="showEdit[scope.$index] && (statu === 7 || statu === 4)">${ compatibilityinv[scope.$index+(currentPage-1)*pageSize] }</span>
                </template>
            </el-table-column>

        </el-table-column>
{#        <el-table-column label="INV for RD" align="center">#}
{#            <el-table-column label="ESD" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.ESDINV"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ esdinv[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="EMI" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.EMIINV"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ eminv[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#            <el-table-column label="RF" width="50" align="center">#}
{#                <template slot-scope="scope">#}
{#                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 2 || statu === 4)"    v-model="scope.row.RFINV"></el-input>#}
{#                      <span v-else="showEdit[scope.$index] && (statu === 2 || statu === 4)">${ rfinv[scope.$index+(currentPage-1)*pageSize] }</span>#}
{#                </template>#}
{#            </el-table-column>#}
{#        </el-table-column>#}
        <el-table-column label="Control run" width="100" align="center">
            <template slot-scope="scope">
                      <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Controlrun"></el-input>
                      <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ controlrun[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column  label="SP" width="40" align="center">
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.SourcePriority"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ sourcepriority[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column  label="Compal P/N" width="113" align="center" >
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.CompalPN"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ compalPN[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column  label="Status" align="center">
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Status"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ status[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column label="Vendor P/N" width="100" align="center">
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.VendorPN"></el-input>
                  <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ vendorPN[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column label="Description" align="center" width="204" >
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Description"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ description[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column label="Qty" align="center">
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Qty"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ qty[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column label="Location" align="center" width="126">
             <template slot-scope="scope">
            <el-input class="edit-cell" v-if="showEdit[scope.$index] && (statu === 6 || statu === 4)"    v-model="scope.row.Location"></el-input>
                 <span v-else="showEdit[scope.$index] && (statu === 6 || statu === 4)">${ location[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>

        <el-table-column label="Comments" width="500" align="left" >
            <template slot-scope="scope">
                      <textarea class="edit-cell" v-if="showEdit[scope.$index]&& (statu === 2 || statu === 3|| statu === 4|| statu === 5|| statu === 6)" cols="50" rows="4"  v-model="scope.row.Comment"></textarea>
                      <span style="white-space: pre-line" v-if="!showEdit[scope.$index]&& (statu === 2 || statu === 3|| statu === 4|| statu === 5|| statu === 6)">${ comments[scope.$index+(currentPage-1)*pageSize] }</span>
            </template>
        </el-table-column>
        <el-table-column label="操作" width="120" align="center" fixed="right">
        <template slot-scope="scope">
            <el-button type="text" size="small"     @click.native="saveRow(scope.$index, scope.row)"     v-if="showBtn[scope.$index]">保存</el-button>
            <el-button type="text" size="small"     @click.native="cancelRow(scope.$index, scope.row)"     v-if="showBtn[scope.$index]">取消</el-button>

            <el-button type="text" size="big"     @click.native="editRow(scope.$index, scope.row)"    v-if="!showBtn[scope.$index]">编辑</el-button>
        </template>
        </el-table-column>
        <el-table-column align="right">
        <template slot="header" slot-scope="scope">
        <el-input v-model="search" size="mini" placeholder="输入关键字模糊搜索"/>
        </template>
        </el-table-column>
    </el-table>
    <div class="block">
    <el-pagination  @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="currentPage" :page-sizes="[10, 50, 100, 200]" :page-size="pageSize" layout="total, sizes, prev, pager, next, jumper" :total="totalNum">
    </el-pagination>
  </div>
</template>
</div>
{% endblock %}
{% block scripts %}
<script src="/static/js/es6/polyfill.min.js"></script>
<script src="/static/js/es6/babel.min.js"></script>
<script src="/static/js/axios.min.js"></script>
<script src="/static/js/vue.min.js"></script>
<script src="/static/js/qs.js"></script>
<script src="/static/js/Element/index.js"></script>
<script type="text/babel">
$(document).ready(function() {
    $("#yincang").click(function () {
        $("#container-yansebiaoshi").toggle();
    });
    $("body").click(function (e) {
    if (!$(e.target).closest("#yincang").length) {
        $("#container-yansebiaoshi").hide();
    }
    });
})
    new Vue({
        el: '#app',
        delimiters: ['${', '}'],
        data: function () {
            return {
                options: [{value: 'QS', label: 'QS'}, {value: 'Qd_L', label: 'Qd_L'}, {value: 'Qd_C', label: 'Qd_C'}, {value: 'QT', label: 'QT'}, {value: 'QF', label: 'QF'}, {value: 'DisQ', label: 'DisQ'}, {value: 'Drop', label: 'Drop'}, {value: 'Not Build', label: 'Not Build'}],
                visible: false,
                tableContent: [],
                    project:[],
                    category:[],
                    name:[],
                vendor:[],
                sourcepriority:[],
                compalPN:[],
                status:[],
                vendorPN:[],
                description:[],
                qty:[],
                location:[],
                datacodeb:[],
                reliabilityb:[],
                compatibilityb:[],
                resultforb:[],
                esdb:[],
                emib:[],
                rfb:[],
                datacodec:[],
                reliabilityc:[],
                compatibilityc:[],
                resultforc:[],
                esdc:[],
                emic:[],
                rfc:[],
                    datacodeinv:[],
                    reliabilityinv:[],
                    compatibilityinv:[],
                    resultforinv:[],
                    esdinv:[],
                    emiinv:[],
                    rfinv:[],
                controlrun:[],
                comments:[],
                 Comment:null,
                showEdit: [], //显示编辑框
                showBtn: [],
                showBtnOrdinary: true,
                selectedCustomer:null,
                selectedProject:null,
                selectedPhase:null,
                selectPhase:null,
                selectProject:[],
                selectItem:{},
                selectId:null,
                statu:null,
                flag:null,
                currentPage: 1,//默认显示第一页
                pageSize:100,//默认每页显示100条
                totalNum: null,
                search: '',
                multiDeleteVisible:false,
                multipleSelection: [],

            }
        },
         computed: {
                // 前端过滤
                tables () {
                  const search = this.search
                  if (search) {
                    return this.tableData.filter(dataNews => {
                      return Object.keys(dataNews).some(key => {
                        return String(dataNews[key]).toLowerCase().indexOf(search) > -1
                      })
                    })
                  }
                  return this.tableData
                },
                // 总条数
                total () {
                  return this.tables.length
                }
              },

        

        mounted(){        // 页面渲染后触发该区域内容 即页面初始化
            this.getdata("first");
        },
        methods: {
            // 前端过滤
            format (val) {
              val = val.toString()
              if (val.indexOf(this.search) !== -1 && this.search !== '') {
                return val.replace(this.search, '<font color="red">' + this.search + '</font>')
              } else {
                return val
              }
            },
            dateFormat (val) {
              return moment(val).format('YYYY-MM-DD')
            },

            siteTableHeader () {
              return 'sws-table-header'
            },
            tableRowClassName ({ row, rowIndex }) {
              if (rowIndex % 2) {
                return 'warning-row'
              } else {
                return 'success-row'
              }
            },

            handleSizeChange(val) {
        console.log(`每页 ${val} 条`);
                this.pageSize = val;
          },
          handleCurrentChange(val) {
            console.log(`当前页: ${val}`);
              this.currentPage = val;
              console.log(this.tableContent.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize));
          },
            //获取数据
            getdata: function (e) {
                let data = {"isGetData": e, "csrfmiddlewaretoken": $("[name='csrfmiddlewaretoken']").val()};
                axios.post("/MQM/MQM_edit/", Qs.stringify(data), {
                    headers: {'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                }).then((res) => {
                    this.tableContent = res.data.content;
                    this.selectItem=res.data.select;
                    this.totalNum=this.tableContent.length;
                    //this.statu=res.data.orr;

                    for(let i=0;i<this.tableContent.length;i++) {
                               this.project[i] =this.tableContent[i].Project;
                               this.category[i] = this.tableContent[i].Category;
                               this.name[i] = this.tableContent[i].Name;
                        this.vendor[i] = this.tableContent[i].Vendor;
                        this.sourcepriority[i] = this.tableContent[i].SourcePriority;
                        this.compalPN[i] = this.tableContent[i].CompalPN;
                        this.status[i] = this.tableContent[i].Status;
                        this.vendorPN[i] = this.tableContent[i].VendorPN;
                        this.description[i] = this.tableContent[i].Description;
                        this.qty[i] = this.tableContent[i].Qty;
                        this.location[i] = this.tableContent[i].Location;
                        this.datacodeb[i] = this.tableContent[i].DataCodeB;
                        this.reliabilityb[i] = this.tableContent[i].ReliabilityB;
                        this.compatibilityb[i] = this.tableContent[i].CompatibilityB;
                        this.resultforb[i] = this.tableContent[i].ResultforB;
                        this.esdb[i] = this.tableContent[i].ESDB;
                        this.emib[i] = this.tableContent[i].EMIB;
                        this.rfb[i] = this.tableContent[i].RFB;
                        this.datacodec[i] = this.tableContent[i].DataCodeC;
                        this.reliabilityc[i] = this.tableContent[i].ReliabilityC;
                        this.compatibilityc[i] = this.tableContent[i].CompatibilityC;
                        this.resultforc[i] = this.tableContent[i].ResultforC;
                        this.esdc[i] = this.tableContent[i].ESDC;
                        this.emic[i] = this.tableContent[i].EMIC;
                        this.rfc[i] = this.tableContent[i].RFC;
                                this.datacodeinv[i] = this.tableContent[i].DataCodeINV;
                                this.reliabilityinv[i] = this.tableContent[i].ReliabilityINV;
                                this.compatibilityinv[i] = this.tableContent[i].CompatibilityINV;
                                this.resultforinv[i] = this.tableContent[i].ResultforINV;
                                this.esdinv[i] = this.tableContent[i].ESDINV;
                                this.emiinv[i] = this.tableContent[i].EMIINV;
                                this.rfinv[i] = this.tableContent[i].RFINV;
                        this.controlrun[i] = this.tableContent[i].Controlrun;
                        this.comments[i] = this.tableContent[i].Comments;
                    }
                });
            },
            //索引
            indexMethod(index) {
                    return index +1;
            },
            //编辑
            editRow(index, row,cell) {
            this.$set(this.showEdit,index,true);
            this.$set(this.showBtn,index,true);
            },
            //保存
            saveRow(index,rows) {
                    let Customer = this.$refs.Customer.value;
                    let Project = this.$refs.Project.value;
                    let data = {"isGetData": "SAVE", "rows": rows,"Customer":Customer,"Project":Project, "csrfmiddlewaretoken": $("[name='csrfmiddlewaretoken']").val()
                    };
                    axios.post("/MQM/MQM_edit/", data, {
                        //headers: {'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                    }).then((res) => {
                         this.tableContent = res.data.content;
                         this.flag=res.data.orn;
                         this.statu=res.data.orr;
                        console.log(this.flag);
                        for (let i = 0; i < this.tableContent.length; i++) {
                                this.project[i] =this.tableContent[i].Project;
                                this.category[i] = this.tableContent[i].Category;
                                this.name[i] = this.tableContent[i].Name;
                            this.vendor[i] = this.tableContent[i].Vendor;
                            this.sourcepriority[i] = this.tableContent[i].SourcePriority;
                            this.compalPN[i] = this.tableContent[i].CompalPN;
                            this.status[i] = this.tableContent[i].Status;
                            this.vendorPN[i] = this.tableContent[i].VendorPN;
                            this.description[i] = this.tableContent[i].Description;
                            this.qty[i] = this.tableContent[i].Qty;
                            this.location[i] = this.tableContent[i].Location;
                            this.datacodeb[i] = this.tableContent[i].DataCodeB;
                            this.reliabilityb[i] = this.tableContent[i].ReliabilityB;
                            this.compatibilityb[i] = this.tableContent[i].CompatibilityB;
                            this.resultforb[i] = this.tableContent[i].ResultforB;
                            this.esdb[i] = this.tableContent[i].ESDB;
                            this.emib[i] = this.tableContent[i].EMIB;
                            this.rfb[i] = this.tableContent[i].RFB;
                            this.datacodec[i] = this.tableContent[i].DataCodeC;
                            this.reliabilityc[i] = this.tableContent[i].ReliabilityC;
                            this.compatibilityc[i] = this.tableContent[i].CompatibilityC;
                            this.resultforc[i] = this.tableContent[i].ResultforC;
                            this.esdc[i] = this.tableContent[i].ESDC;
                            this.emic[i] = this.tableContent[i].EMIC;
                            this.rfc[i] = this.tableContent[i].RFC;
                                this.datacodeinv[i] = this.tableContent[i].DataCodeINV;
                                this.reliabilityinv[i] = this.tableContent[i].ReliabilityINV;
                                this.compatibilityinv[i] = this.tableContent[i].CompatibilityINV;
                                this.resultforinv[i] = this.tableContent[i].ResultforINV;
                                this.esdinv[i] = this.tableContent[i].ESDINV;
                                this.emiinv[i] = this.tableContent[i].EMIINV;
                                this.rfinv[i] = this.tableContent[i].RFINV;
                            this.controlrun[i] = this.tableContent[i].Controlrun;
                            this.comments[i] = this.tableContent[i].Comments;
                        }

                        if(this.flag==0) {
                    this.$set(this.showEdit, index, false);
                    this.$set(this.showBtn, index, false);//关闭页面
                }else{
                    alert(this.flag);
                }
                    });


           },
            //取消编辑
            cancelRow(index, row) {
                    this.tableContent[index].Project=this.project[index];
                    this.tableContent[index].Category=this.category[index];
                    this.tableContent[index].Name=this.name[index];
               this.tableContent[index].Vendor=this.vendor[index];
               this.tableContent[index].SourcePriority=this.sourcepriority[index];
               this.tableContent[index].CompalPN=this.compalPN[index];
               this.tableContent[index].Status=this.status[index];
               this.tableContent[index].VendorPN=this.vendorPN[index];
               this.tableContent[index].Description=this.description[index];
               this.tableContent[index].Qty=this.qty[index];
               this.tableContent[index].Location=this.location[index];
               this.tableContent[index].DataCodeB=this.datacodeb[index];
               this.tableContent[index].ReliabilityB=this.reliabilityb[index];
               this.tableContent[index].CompatibilityB=this.compatibilityb[index];
               this.tableContent[index].ResultforB=this.resultforb[index];
               this.tableContent[index].ESDB=this.esdb[index];
               this.tableContent[index].EMIB=this.emib[index];
               this.tableContent[index].RFB=this.rfb[index];
               this.tableContent[index].DataCodeC=this.datacodec[index];
               this.tableContent[index].ReliabilityC=this.reliabilityc[index];
               this.tableContent[index].CompatibilityC=this.compatibilityc[index];
               this.tableContent[index].ResultforC=this.resultforc[index];
               this.tableContent[index].ESDC=this.esdc[index];
               this.tableContent[index].EMIC=this.emic[index];
               this.tableContent[index].RFC=this.rfc[index];
                    this.tableContent[index].DataCodeINV=this.datacodeinv[index];
                    this.tableContent[index].ReliabilityINV=this.reliabilityinv[index];
                    this.tableContent[index].CompatibilityINV=this.compatibilityinv[index];
                    this.tableContent[index].ResultforINV=this.resultforinv[index];
                    this.tableContent[index].ESDINV=this.esdinv[index];
                    this.tableContent[index].EMIINV=this.emiinv[index];
                    this.tableContent[index].RFINV=this.rfinv[index];
               this.tableContent[index].Controlrun=this.controlrun[index];
               this.tableContent[index].Comments=this.comments[index];
             this.$set(this.showEdit,index,false);
             this.$set(this.showBtn,index,false) ;
           },
            //级联
            changeCustomer:function () {
                 if(this.$refs.Customer.value ==""){
                      this.selectProject=[""];
                      return false;
                 }
                 this.selectProject=this.selectItem[this.$refs.Customer.value];
                 this.selectedProject="";
                 console.log(this.selectProject);
             },
            changeProject:function(index){
                if(this.$refs.Project.value ==""){
                      this.selectPhase=[""];
                      return false;
                 }
                for(let index=0;index<this.selectItem[this.selectedCustomer].length;index++){
                     if(this.selectItem[this.selectedCustomer][index]["Project"]==this.selectedProject){
                        this.selectPhase=this.selectItem[this.selectedCustomer][index]["Phase"];
                    }
                }
            },
            //上传搜索项：以此选项搜索符合条件的内容
            selectMsg :function(){
               let Customer = this.$refs.Customer.value;
               let Project = this.$refs.Project.value;
               let data ={"isGetData":"SEARCH","Customer":Customer,"Project":Project,"csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val()}
               axios.post("/MQM/MQM_edit/",Qs.stringify(data), {
               headers:{ 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'}
                }).then((res) => {
                  console.log(res.data.content,'111');
                  this.tableContent=res.data.content;
                  this.statu=res.data.orr;
                  this.selectItem=res.data.select;
                  this.totalNum=this.tableContent.length;
                  console.log(res.data.orr,this.statu,typeof (this.statu),'yyy')
                   for (let i = 0; i < this.tableContent.length; i++) {
                                this.project[i] =this.tableContent[i].Project;
                                this.category[i] = this.tableContent[i].Category;
                                this.name[i] = this.tableContent[i].Name;
                            this.vendor[i] = this.tableContent[i].Vendor;
                            this.sourcepriority[i] = this.tableContent[i].SourcePriority;
                            this.compalPN[i] = this.tableContent[i].CompalPN;
                            this.status[i] = this.tableContent[i].Status;
                            this.vendorPN[i] = this.tableContent[i].VendorPN;
                            this.description[i] = this.tableContent[i].Description;
                            this.qty[i] = this.tableContent[i].Qty;
                            this.location[i] = this.tableContent[i].Location;
                            this.datacodeb[i] = this.tableContent[i].DataCodeB;
                            this.reliabilityb[i] = this.tableContent[i].ReliabilityB;
                            this.compatibilityb[i] = this.tableContent[i].CompatibilityB;
                            this.resultforb[i] = this.tableContent[i].ResultforB;
                            this.esdb[i] = this.tableContent[i].ESDB;
                            this.emib[i] = this.tableContent[i].EMIB;
                            this.rfb[i] = this.tableContent[i].RFB;
                            this.datacodec[i] = this.tableContent[i].DataCodeC;
                            this.reliabilityc[i] = this.tableContent[i].ReliabilityC;
                            this.compatibilityc[i] = this.tableContent[i].CompatibilityC;
                            this.resultforc[i] = this.tableContent[i].ResultforC;
                            this.esdc[i] = this.tableContent[i].ESDC;
                            this.emic[i] = this.tableContent[i].EMIC;
                            this.rfc[i] = this.tableContent[i].RFC;
                                this.datacodeinv[i] = this.tableContent[i].DataCodeINV;
                                this.reliabilityinv[i] = this.tableContent[i].ReliabilityINV;
                                this.compatibilityinv[i] = this.tableContent[i].CompatibilityINV;
                                this.resultforinv[i] = this.tableContent[i].ResultforINV;
                                this.esdinv[i] = this.tableContent[i].ESDINV;
                                this.emiinv[i] = this.tableContent[i].EMIINV;
                                this.rfinv[i] = this.tableContent[i].RFINV;
                            this.controlrun[i] = this.tableContent[i].Controlrun;
                            this.comments[i] = this.tableContent[i].Comments;
                        }
                })
             },
           changeresultB:function(rows,index){
                if(rows.ReliabilityB==''|| rows.CompatibilityB==''){
                    rows.ResultforB='';
                }
                else if(rows.ReliabilityB=='Not Build'|| (rows.CompatibilityB=='Not Build'&& rows.CompatibilityB!=='')){
                    rows.ResultforB='Not Build';
                }
                else if(rows.ReliabilityB=='QS'&& rows.CompatibilityB=='QS'){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='Drop'&& rows.CompatibilityB!=='Not Build'&& rows.CompatibilityB!==''){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='DisQ'&& rows.CompatibilityB!=='Not Build'&& rows.CompatibilityB!=='Drop'&& rows.CompatibilityB!==''){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='QF'&& rows.CompatibilityB!=='Not Build'&& rows.CompatibilityB!=='Drop'&& rows.CompatibilityB!=='DisQ'&& rows.CompatibilityB!==''){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='QT'&& rows.CompatibilityB!=='Not Build'&& rows.CompatibilityB!=='Drop'&& rows.CompatibilityB!=='DisQ'&& rows.CompatibilityB!=='QF'&& rows.CompatibilityB!==''){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='Qd_C'&& rows.CompatibilityB!=='Not Build'&& rows.CompatibilityB!=='Drop'&& rows.CompatibilityB!=='DisQ'&& rows.CompatibilityB!=='QF'&& rows.CompatibilityB!=='QT'&& rows.CompatibilityB!==''){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else if(rows.ReliabilityB=='Qd_L'&& rows.CompatibilityB=='QS'){
                    rows.ResultforB=rows.ReliabilityB;
                }
                else{
                    rows.ResultforB=rows.CompatibilityB;
                }
            },
            changeresultC:function(rows,index){
                console.log(rows.ReliabilityC,rows.CompatibilityC,rows.ReliabilityC=='Drop',rows.CompatibilityC!=='Not Build',rows.ReliabilityC=='Drop'&& rows.CompatibilityC!=='Not Build',"g");
                //console.log(rows.ResultforC,'f')
                if(rows.ReliabilityC==''|| rows.CompatibilityC==''){
                    rows.ResultforC='';
                }
                else  if(rows.ReliabilityC=='Not Build'|| (rows.CompatibilityC=='Not Build'&&rows.CompatibilityC!=='')){
                      rows.ResultforC='Not Build';
                }
                else if(rows.ReliabilityC=='QS'&& rows.CompatibilityC=='QS'){
                    rows.ResultforC='QS';
                }

                else if(rows.ReliabilityC=='Drop'&& rows.CompatibilityC!=='Not Build'&&rows.CompatibilityC!==''){
                    rows.ResultforC=rows.ReliabilityC;
                }
                else if(rows.ReliabilityC=='DisQ'&& rows.CompatibilityC!=='Not Build'&& rows.CompatibilityC!=='Drop'&&rows.CompatibilityC!==''){
                    rows.ResultforC='DisQ';
                }
                else if(rows.ReliabilityC=='QF'&& rows.CompatibilityC!=='Not Build'&& rows.CompatibilityC!=='Drop'&& rows.CompatibilityC!=='DisQ'&&rows.CompatibilityC!==''){
                    rows.ResultforC='QF';
                }
                else if(rows.ReliabilityC=='QT'&& rows.CompatibilityC!=='Not Build'&& rows.CompatibilityC!=='Drop'&& rows.CompatibilityC!=='DisQ'&& rows.CompatibilityC!=='QF'&&rows.CompatibilityC!==''){
                    rows.ResultforC='QT';
                }
                else if(rows.ReliabilityC=='Qd_C'&& rows.CompatibilityC!=='Not Build'&& rows.CompatibilityC!=='Drop'&& rows.CompatibilityC!=='DisQ'&& rows.CompatibilityC!=='QF'&& rows.CompatibilityC!=='QT'&&rows.CompatibilityC!==''){
                    rows.ResultforC='Qd_C';
                }
                else if(rows.ReliabilityC=='Qd_L'&& rows.CompatibilityC=='QS'){
                    rows.ResultforC='Qd_L';
                }
                else{
                    rows.ResultforC=rows.CompatibilityC;
                }
            },
            changeresultINV:function(rows,index){
                if(rows.ReliabilityINV==''|| rows.CompatibilityINV==''){
                    rows.ResultforINV='';
                }
                else if(rows.ReliabilityINV=='Not Build'|| (rows.CompatibilityINV=='Not Build'&& rows.CompatibilityINV !=='')){
                    rows.ResultforINV='Not Build';
                }
                else if(rows.ReliabilityINV=='QS'&& rows.CompatibilityINV=='QS'){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='Drop'&& rows.CompatibilityINV!=='Not Build'&& rows.CompatibilityINV !==''){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='DisQ'&& rows.CompatibilityINV!=='Not Build'&& rows.CompatibilityINV!=='Drop'&& rows.CompatibilityINV !==''){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='QF'&& rows.CompatibilityINV!=='Not Build' && rows.CompatibilityINV!=='Drop' && rows.CompatibilityINV!=='DisQ'&& rows.CompatibilityINV !==''){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='QT'&& rows.CompatibilityINV!=='Not Build'&& rows.CompatibilityINV !== 'Drop' && rows.CompatibilityINV!=='DisQ'&& rows.CompatibilityC!=='QF'&& rows.CompatibilityINV !==''){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='Qd_C'&& (rows.CompatibilityINV=='QS'|| rows.CompatibilityINV=='Qd_L')){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else if(rows.ReliabilityINV=='Qd_L'&& rows.CompatibilityINV=='QS'){
                    rows.ResultforINV=rows.ReliabilityINV;
                }
                else{
                    rows.ResultforINV=rows.CompatibilityINV;
                }
            },
           addClass({row, column, rowIndex, columnIndex}) {
                console.log('addcolor',rowIndex, columnIndex)
                if (columnIndex === 7 && (row.ReliabilityB === 'QS'|| row.ReliabilityB === 'Qd_L'|| row.ReliabilityB === 'Qd_C')) {
                    console.log("lie",row)
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 8 && (row.CompatibilityB === 'QS'|| row.CompatibilityB === 'Qd_L'|| row.CompatibilityB === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 6 && (row.ResultforB === 'QS'|| row.ResultforB === 'Qd_L'|| row.ResultforB === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 11 && (row.ReliabilityC === 'QS'|| row.ReliabilityC === 'Qd_L'|| row.ReliabilityC === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 12 && (row.CompatibilityC === 'QS'|| row.CompatibilityC === 'Qd_L'|| row.CompatibilityC === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 10 && (row.ResultforC === 'QS'|| row.ResultforC === 'Qd_L'|| row.ResultforC === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 15 && (row.ReliabilityINV === 'QS'|| row.ReliabilityINV === 'Qd_L'|| row.ReliabilityINV === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 16 && (row.CompatibilityINV === 'QS'|| row.CompatibilityINV === 'Qd_L'|| row.CompatibilityINV === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }
                if (columnIndex === 14 && (row.ResultforINV === 'QS'|| row.ResultforINV === 'Qd_L'|| row.ResultforINV === 'Qd_C')) {
                        return {
                                  background: '#00FF00'
                                }
                }

                if (columnIndex === 7 && row.ReliabilityB === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 8 && row.CompatibilityB === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 6 && row.ResultforB === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 11 && row.ReliabilityC === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 12 && row.CompatibilityC === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 10 && row.ResultforC === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 15 && row.ReliabilityINV === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 16 && row.CompatibilityINV === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }
                if (columnIndex === 14 && row.ResultforINV === 'QT') {
                        return {
                                  background: '#FFFF00'
                                }
                }


                if (columnIndex === 7 && (row.ReliabilityB === 'QF'|| row.ReliabilityB === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 8 && (row.CompatibilityB === 'QF'||row.CompatibilityB === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 6 && (row.ResultforB === 'QF'|| row.ResultforB === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 11 && (row.ReliabilityC === 'QF'||row.ReliabilityC === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 12 && (row.CompatibilityC === 'QF'|| row.CompatibilityC === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 10 && (row.ResultforC === 'QF'|| row.ResultforC === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 15 && (row.ReliabilityINV === 'QF'|| row.ReliabilityINV === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 16 && (row.CompatibilityINV === 'QF'|| row.CompatibilityINV === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }
                if (columnIndex === 14 && (row.ResultforINV === 'QF'|| row.ResultforINV === 'DisQ')) {
                        return {
                                  background: '#FF0000'
                                }
                }


                if (columnIndex === 7 && (row.ReliabilityB === 'Drop'|| row.ReliabilityB === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 8 && (row.CompatibilityB === 'Drop'|| row.CompatibilityB === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 6 && (row.ResultforB === 'Drop'|| row.ResultforB === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 11 && (row.ReliabilityC === 'Drop'|| row.ReliabilityC === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 12 && (row.CompatibilityC === 'Drop'|| row.CompatibilityC === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 10 && (row.ResultforC === 'Drop'|| row.ResultforC === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 15 && (row.ReliabilityINV === 'Drop'|| row.ReliabilityINV === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 16 && (row.CompatibilityINV === 'Drop'|| row.CompatibilityINV === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }
                if (columnIndex === 14 && (row.ResultforINV === 'Drop'|| row.ResultforINV === 'Not Build')) {
                        return {
                                  background: '#696969'
                                }
                }

                },
             handleSelectionChange(rows) {
                this.multipleSelection = rows;
            },
         getRowKeys (row) {
              return row.id
            },
          multiDelete() {
                var warning=confirm('此操作将永久删除该条数据, 是否继续?')
         if(warning) {
             this.multiDeleteVisible = false;
             let checkArr = this.multipleSelection;   // multipleSelection存储了勾选到的数据
             let params = [];
             let self = this;
             checkArr.forEach(function (item) {
                 console.log(item);
                 params.push(item.id);       // 添加所有需要删除数据的id到一个数组，post提交过去
             });
             console.log(params);
              let Customer = this.$refs.Customer.value;
               let Project = this.$refs.Project.value;
             let data = {
                 "isGetData": "MUTIDELETE",
                 "params": params,
                 "Customer":Customer,"Project":Project,
                 "csrfmiddlewaretoken": $("[name='csrfmiddlewaretoken']").val()
             };
             axios.post('/MQM/MQM_edit/', data).then((res) =>{

                     this.tableContent = res.data.content;
                     console.log(this.tableContent,'mul')
                       for(let i=0;i<this.tableContent.length;i++) {
                               this.project[i] =this.tableContent[i].Project;
                               this.category[i] = this.tableContent[i].Category;
                               this.name[i] = this.tableContent[i].Name;
                        this.vendor[i] = this.tableContent[i].Vendor;
                        this.sourcepriority[i] = this.tableContent[i].SourcePriority;
                        this.compalPN[i] = this.tableContent[i].CompalPN;
                        this.status[i] = this.tableContent[i].Status;
                        this.vendorPN[i] = this.tableContent[i].VendorPN;
                        this.description[i] = this.tableContent[i].Description;
                        this.qty[i] = this.tableContent[i].Qty;
                        this.location[i] = this.tableContent[i].Location;
                        this.datacodeb[i] = this.tableContent[i].DataCodeB;
                        this.reliabilityb[i] = this.tableContent[i].ReliabilityB;
                        this.compatibilityb[i] = this.tableContent[i].CompatibilityB;
                        this.resultforb[i] = this.tableContent[i].ResultforB;
                        this.esdb[i] = this.tableContent[i].ESDB;
                        this.emib[i] = this.tableContent[i].EMIB;
                        this.rfb[i] = this.tableContent[i].RFB;
                        this.datacodec[i] = this.tableContent[i].DataCodeC;
                        this.reliabilityc[i] = this.tableContent[i].ReliabilityC;
                        this.compatibilityc[i] = this.tableContent[i].CompatibilityC;
                        this.resultforc[i] = this.tableContent[i].ResultforC;
                        this.esdc[i] = this.tableContent[i].ESDC;
                        this.emic[i] = this.tableContent[i].EMIC;
                        this.rfc[i] = this.tableContent[i].RFC;
                                this.datacodeinv[i] = this.tableContent[i].DataCodeINV;
                                this.reliabilityinv[i] = this.tableContent[i].ReliabilityINV;
                                this.compatibilityinv[i] = this.tableContent[i].CompatibilityINV;
                                this.resultforinv[i] = this.tableContent[i].ResultforINV;
                                this.esdinv[i] = this.tableContent[i].ESDINV;
                                this.emiinv[i] = this.tableContent[i].EMIINV;
                                this.rfinv[i] = this.tableContent[i].RFINV;
                        this.controlrun[i] = this.tableContent[i].Controlrun;
                        this.comments[i] = this.tableContent[i].Comments;
                    }
                     self.$message({
                         message: '删除成功',
                         type: 'success'
                     });
                 this.selectItem=res.data.select;
             })
         }else{
             return false;
         }
            },

        }
    })
</script>
{% endblock %}{% endcomment %}
